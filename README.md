# ãƒ™ãƒ³ãƒªãã‚“ SharePointã®ãƒ•ã‚©ãƒ«ãƒ€URLã¨ã‹ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ

## å…è²¬äº‹é …

**ã“ã®ãƒ„ãƒ¼ãƒ«ã®ä½¿ç”¨ã¯è‡ªå·±è²¬ä»»ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚**

- ä½œè€…ã¯æœ¬ãƒ„ãƒ¼ãƒ«ã®ä½¿ç”¨ã«ã‚ˆã£ã¦ç”Ÿã˜ã‚‹æå®³ã«ã¤ã„ã¦ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“
- æœ¬ãƒ„ãƒ¼ãƒ«ã¯Microsoftç¤¾ã¨ã¯ç„¡é–¢ä¿‚ã®éå…¬å¼ãƒ„ãƒ¼ãƒ«ã§ã™
- SharePointã®ä»•æ§˜å¤‰æ›´ã«ã‚ˆã‚Šå‹•ä½œã—ãªããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™

---

SharePoint Onlineã®ãƒ•ã‚©ãƒ«ãƒ€ãƒšãƒ¼ã‚¸ã§ãƒ•ã‚©ãƒ«ãƒ€URLã¨ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’ã¾ã¨ã‚ã¦ã‚³ãƒ”ãƒ¼ã§ããŸã‚Šã™ã‚‹ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã§ã™ã€‚

## ã§ãã‚‹ã“ã¨

SharePointã®ãƒ•ã‚©ãƒ«ãƒ€ãƒšãƒ¼ã‚¸ã§ãƒ•ã‚©ãƒ«ãƒ€åã€URLã€ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’ä¸€åº¦ã«ã‚³ãƒ”ãƒ¼ã§ãã¾ã™ã€‚Teamsã‚„Outlookã«è²¼ã‚Šä»˜ã‘ã‚‹ã¨ãƒªãƒ³ã‚¯ã‚„è£…é£¾ãŒä¿æŒã•ã‚Œã¾ã™ã€‚

10ç¨®é¡ã®å½¢å¼ã‹ã‚‰ç”¨é€”ã«å¿œã˜ã¦é¸æŠå¯èƒ½ã§ã€ã‚µã‚¤ãƒˆåã‹ã‚‰ãƒ•ã‚©ãƒ«ãƒ€ã¾ã§ã®éšå±¤æ§‹é€ ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

## ã‚³ãƒ”ãƒ¼å½¢å¼

### ãƒªãƒ³ã‚¯ä»˜ãã‚³ãƒ”ãƒ¼ï¼ˆTeams/Outlookå‘ã‘ï¼‰
- **å…¨éƒ¨ç››ã‚Šï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰** - ãƒ•ã‚©ãƒ«ãƒ€æƒ…å ± + ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ + éšå±¤ãƒ‘ã‚¹
- **å…¨éƒ¨ç››ã‚Šï¼ˆãƒªãƒƒãƒï¼‰** - ä¸Šè¨˜ + ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡ã‚¢ã‚¤ã‚³ãƒ³ä»˜ã
- **ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆãƒªãƒ³ã‚¯ï¼‰ã®ã¿** - ãƒ•ã‚©ãƒ«ãƒ€åã¨URLã®ã¿
- **ãƒ•ã‚©ãƒ«ãƒ€+ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰** - ãƒ•ã‚©ãƒ«ãƒ€æƒ…å ± + ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ»Enterã‚­ãƒ¼å¯¾å¿œï¼‰
- **ãƒ•ã‚©ãƒ«ãƒ€+ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆãƒªãƒƒãƒï¼‰** - ä¸Šè¨˜ + ãƒ•ã‚¡ã‚¤ãƒ«ç¨®é¡ã‚¢ã‚¤ã‚³ãƒ³ä»˜ã

### ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ”ãƒ¼
- **ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§ï¼ˆå¼•ç”¨ï¼‰** - ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’å¼•ç”¨å½¢å¼ã§
- **ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§ï¼ˆç®‡æ¡æ›¸ãï¼‰** - ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã‚’ç®‡æ¡æ›¸ãå½¢å¼ã§  
- **ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§** - ãƒ•ã‚¡ã‚¤ãƒ«åã®ã¿ã‚·ãƒ³ãƒ—ãƒ«ã«
- **è©³ç´°ãƒ‘ã‚¹ï¼ˆTreeï¼‰** - éšå±¤æ§‹é€ ã‚’ãƒ„ãƒªãƒ¼å½¢å¼ã§
- **è©³ç´°ãƒ‘ã‚¹ï¼ˆãƒ‘ãƒ³ããšï¼‰** - éšå±¤æ§‹é€ ã‚’ãƒ‘ãƒ³ããšå½¢å¼ã§

## ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚³ãƒ¼ãƒ‰

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®URLã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ï¼š

```javascript
javascript:(function(){'use strict';const CONFIG={ui:{dialogWidth:'min(720px, 95vw)',dialogHeight:'auto',messageTimeout:2000,elementTimeout:3000,pathDisplay:{hideForTopLevel:true,maxPathLength:50,showHierarchical:true,hierarchicalMaxDepth:5}},selectors:{modernUI:['[data-app-name="Files"]','[data-app-name*="Files"]','[aria-label*="Files"]','.ms-FocusZone[data-automation-id="contentScrollRegion"]','[data-automation-id="pageHeader"]'],classicUI:['#s4-workspace','.ms-cui-breadcrumb','#RibbonContainer'],newNav:['.root-39'],breadcrumbs:['[data-automationid="breadcrumb-root-id"]','.breadcrumbList_9b39d68a','[class*="breadcrumbList"]','[data-automationid*="breadcrumb"]','.breadcrumbList','[data-automation-id="breadcrumb"]'],fileRows:{legacy:'.ms-List-cell',modern:'[role="row"]'}},excludePatterns:/^(All Documents|ã™ã¹ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ|Documents|ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ|Home|ãƒ›ãƒ¼ãƒ |åå‰|Name|ãƒ•ã‚¡ã‚¤ãƒ«å|æ›´æ–°æ—¥æ™‚|ã‚µã‚¤ã‚º|AllItems\.aspx)$/i,topLevelFolderPatterns:/^(ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ|Documents|Home|ãƒ›ãƒ¼ãƒ |Shared Documents|å…±æœ‰ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)$/i,fallbackFolderName:'ãƒ•ã‚©ãƒ«ãƒ€',errorHandling:{retryAttempts:2,retryDelay:500,enableDetailedLogging:true,collectErrorStats:true},performance:{enableDOMCache:true,enableParallelSearch:true,cacheTimeout:30000,maxCacheSize:50,smartRetryDelay:true,batchProcessing:true}};const PerformanceOptimizer={domCache:new Map(),cacheTimestamps:new Map(),stats:{cacheHits:0,cacheMisses:0,searchTime:[],parallelSearches:0},getCachedResult(selector){if(!CONFIG.performance.enableDOMCache)return null;try{const cached=this.domCache.get(selector);const timestamp=this.cacheTimestamps.get(selector);if(cached&&timestamp&&(Date.now()-timestamp)<CONFIG.performance.cacheTimeout){this.stats.cacheHits++;return cached;}if(cached){this.domCache.delete(selector);this.cacheTimestamps.delete(selector);}this.stats.cacheMisses++;return null;}catch(e){return null;}},setCachedResult(selector,result){if(!CONFIG.performance.enableDOMCache)return;try{if(this.domCache.size>=CONFIG.performance.maxCacheSize){const oldestKey=this.domCache.keys().next().value;this.domCache.delete(oldestKey);this.cacheTimestamps.delete(oldestKey);}this.domCache.set(selector,result);this.cacheTimestamps.set(selector,Date.now());}catch(e){}},async parallelSearch(selectors,searchMethod='querySelector'){if(!CONFIG.performance.enableParallelSearch||selectors.length<=1){return this.sequentialSearch(selectors,searchMethod);}try{const startTime=performance.now();this.stats.parallelSearches++;const searchPromises=selectors.map(async(selector,index)=>{return new Promise((resolve)=>{setTimeout(()=>{try{const cached=this.getCachedResult(selector);if(cached!==null){resolve({selector,result:cached,index,fromCache:true});return;}const result=searchMethod==='querySelectorAll'?document.querySelectorAll(selector):document.querySelector(selector);this.setCachedResult(selector,result);resolve({selector,result,index,fromCache:false});}catch(error){resolve({selector,result:null,index,error,fromCache:false});}},0);});});const results=await Promise.all(searchPromises);const validResult=results.find(r=>r.result&&r.result.length!==0);const endTime=performance.now();this.stats.searchTime.push(endTime-startTime);return validResult?validResult.result:null;}catch(error){return this.sequentialSearch(selectors,searchMethod);}},sequentialSearch(selectors,searchMethod='querySelector'){const startTime=performance.now();for(const selector of selectors){try{const cached=this.getCachedResult(selector);if(cached!==null){return cached;}const result=searchMethod==='querySelectorAll'?document.querySelectorAll(selector):document.querySelector(selector);if(result&&(searchMethod==='querySelector'?result:result.length>0)){this.setCachedResult(selector,result);const endTime=performance.now();this.stats.searchTime.push(endTime-startTime);return result;}}catch(e){continue;}}const endTime=performance.now();this.stats.searchTime.push(endTime-startTime);return null;},calculateRetryDelay(attempt,baseDelay=500){if(!CONFIG.performance.smartRetryDelay){return baseDelay;}const avgSearchTime=this.stats.searchTime.length>0?this.stats.searchTime.reduce((a,b)=>a+b,0)/this.stats.searchTime.length:100;const dynamicDelay=Math.min(Math.max(avgSearchTime*2,100),1000);return Math.min(dynamicDelay*(attempt+1),2000);},clearCache(){this.domCache.clear();this.cacheTimestamps.clear();},getStats(){const avgSearchTime=this.stats.searchTime.length>0?this.stats.searchTime.reduce((a,b)=>a+b,0)/this.stats.searchTime.length:0;return{...this.stats,avgSearchTime:avgSearchTime.toFixed(2),cacheHitRate:this.stats.cacheHits>0?((this.stats.cacheHits/(this.stats.cacheHits+this.stats.cacheMisses))*100).toFixed(1):'0',cacheSize:this.domCache.size};}};const ErrorHandler={ErrorTypes:{DOM_ERROR:'DOM_ERROR',URL_ERROR:'URL_ERROR',CLIPBOARD_ERROR:'CLIPBOARD_ERROR',PERMISSION_ERROR:'PERMISSION_ERROR',NETWORK_ERROR:'NETWORK_ERROR',UNKNOWN_ERROR:'UNKNOWN_ERROR'},stats:{total:0,byType:{},details:[]},classifyError(error,context=''){const message=error.message?.toLowerCase()||'';const name=error.name?.toLowerCase()||'';if(message.includes('element')||message.includes('selector')||message.includes('queryselector')||name.includes('dom')){return this.ErrorTypes.DOM_ERROR;}if(message.includes('url')||message.includes('uri')||context.includes('url')||context.includes('decode')){return this.ErrorTypes.URL_ERROR;}if(message.includes('clipboard')||message.includes('write')||context.includes('clipboard')||context.includes('copy')){return this.ErrorTypes.CLIPBOARD_ERROR;}if(message.includes('permission')||message.includes('denied')||message.includes('forbidden')||name.includes('security')){return this.ErrorTypes.PERMISSION_ERROR;}if(message.includes('network')||message.includes('fetch')||message.includes('request')||name.includes('network')){return this.ErrorTypes.NETWORK_ERROR;}return this.ErrorTypes.UNKNOWN_ERROR;},generateUserMessage(errorType,originalMessage){const baseMessages={[this.ErrorTypes.DOM_ERROR]:'ãƒšãƒ¼ã‚¸ã®è¦ç´ ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚ãƒšãƒ¼ã‚¸ãŒå®Œå…¨ã«è¡¨ç¤ºã•ã‚Œã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚',[this.ErrorTypes.URL_ERROR]:'URLã®è§£æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã®URLã«å•é¡ŒãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚',[this.ErrorTypes.CLIPBOARD_ERROR]:'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã‚’ã”ç¢ºèªãã ã•ã„ã€‚',[this.ErrorTypes.PERMISSION_ERROR]:'æ“ä½œã«å¿…è¦ãªæ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒšãƒ¼ã‚¸ã®æ¨©é™è¨­å®šã‚’ã”ç¢ºèªãã ã•ã„ã€‚',[this.ErrorTypes.NETWORK_ERROR]:'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚æ¥ç¶šçŠ¶æ³ã‚’ã”ç¢ºèªãã ã•ã„ã€‚',[this.ErrorTypes.UNKNOWN_ERROR]:'äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚'};const userMessage=baseMessages[errorType]||baseMessages[this.ErrorTypes.UNKNOWN_ERROR];return `${userMessage}\n\nè©³ç´°: ${originalMessage}`;},updateStats(errorType,error,context){if(!CONFIG.errorHandling.collectErrorStats)return;try{this.stats.total++;this.stats.byType[errorType]=(this.stats.byType[errorType]||0)+1;if(this.stats.details.length<50){this.stats.details.push({timestamp:new Date().toISOString(),type:errorType,message:error.message,context:context});}}catch(e){}},logDetailed(level,errorType,error,context,retryAttempt=0){if(!CONFIG.errorHandling.enableDetailedLogging)return;try{const logData={timestamp:new Date().toISOString(),level:level,errorType:errorType,context:context,retryAttempt:retryAttempt,message:error.message,stack:error.stack,userAgent:navigator.userAgent,url:window.location.href};console[level]('SharePoint Bookmarklet Error:',logData);}catch(e){}},async withRetry(operation,context='',maxRetries=CONFIG.errorHandling.retryAttempts){let lastError=null;for(let attempt=0;attempt<=maxRetries;attempt++){try{return await operation();}catch(error){lastError=error;const errorType=this.classifyError(error,context);this.logDetailed('warn',errorType,error,context,attempt);this.updateStats(errorType,error,context);if(errorType===this.ErrorTypes.PERMISSION_ERROR){break;}if(attempt<maxRetries){const delay=PerformanceOptimizer.calculateRetryDelay(attempt,CONFIG.errorHandling.retryDelay);await new Promise(resolve=>setTimeout(resolve,delay));}}}throw lastError;},async handle(operation,context='',showAlert=false){try{return await this.withRetry(operation,context);}catch(error){const errorType=this.classifyError(error,context);this.logDetailed('error',errorType,error,context);if(showAlert){const userMessage=this.generateUserMessage(errorType,error.message);alert(userMessage);}throw error;}}};function isSharePointSite(){try{const url=window.location.href.toLowerCase();const isSharePointUrl=url.includes('.sharepoint.com')||url.includes('/sites/')||url.includes('/_layouts/')||url.includes('/forms/')||url.includes('/_forms/');const hasSharePointGlobal=typeof _spPageContextInfo!=='undefined';const hasSharePointDOM=!!(document.querySelector('[data-app-name="Files"]')||document.querySelector('.ms-FocusZone[data-automation-id="contentScrollRegion"]')||document.querySelector('#s4-workspace')||document.querySelector('.ms-cui-breadcrumb'));return isSharePointUrl||hasSharePointGlobal||hasSharePointDOM;}catch(e){return false;}}function getH1Content(){try{const h1Elements=document.querySelectorAll('h1');for(const h1 of h1Elements){const text=h1.textContent.trim();if(text&&text.length>0)return text;}return null;}catch(e){return null;}}function getH2Content(){try{const h2Elements=document.querySelectorAll('h2');for(const h2 of h2Elements){const text=h2.textContent.trim();if(text&&text.length>0)return text;}return null;}catch(e){return null;}}function createGenericPageDialog(){const currentUrl=window.location.href;const pageTitle=document.title.trim()||'Untitled Page';const h1Content=getH1Content();const h2Content=getH2Content();const dialog=document.createElement("dialog");dialog.setAttribute('data-spo-bookmarklet','true');dialog.style.width=CONFIG.ui.dialogWidth;dialog.style.height='auto';const titleSelectionSection=`<div class="step-container"><div class="step-header">ğŸ“ ã‚¿ã‚¤ãƒˆãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠã§ã€Œï½œã€é€£çµï¼‰</div><div class="title-cards-container-horizontal"><div class="title-card-horizontal" data-title-type="title"><label class="title-card-label-horizontal"><input type="checkbox" id="titleCheckbox" checked><div class="card-checkbox-area"><div class="selection-indicator-horizontal">âœ“</div></div><div class="card-icon-area"><div class="card-icon-horizontal">ğŸŒ</div></div><div class="card-label-area"><div class="card-title-horizontal">ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«</div></div><div class="card-content-area"><div class="card-content-horizontal">"${pageTitle}"</div></div></label></div>${h1Content?`<div class="title-card-horizontal" data-title-type="h1"><label class="title-card-label-horizontal"><input type="checkbox" id="h1Checkbox"><div class="card-checkbox-area"><div class="selection-indicator-horizontal">âœ“</div></div><div class="card-icon-area"><div class="card-icon-horizontal">ğŸ“–</div></div><div class="card-label-area"><div class="card-title-horizontal">ãƒ¡ã‚¤ãƒ³è¦‹å‡ºã—</div></div><div class="card-content-area"><div class="card-content-horizontal">"${h1Content}"</div></div></label></div>`:''}${h2Content?`<div class="title-card-horizontal" data-title-type="h2"><label class="title-card-label-horizontal"><input type="checkbox" id="h2Checkbox"><div class="card-checkbox-area"><div class="selection-indicator-horizontal">âœ“</div></div><div class="card-icon-area"><div class="card-icon-horizontal">ğŸ“„</div></div><div class="card-label-area"><div class="card-title-horizontal">ã‚µãƒ–è¦‹å‡ºã—</div></div><div class="card-content-area"><div class="card-content-horizontal">"${h2Content}"</div></div></label></div>`:''}    </div></div><div class="step-container"><div class="step-header">âœ¨ ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰</div><div class="title-preview-modern-simple"><div class="preview-content-simple" id="titlePreviewModernSimple"><span id="titlePreview">${pageTitle}</span></div><div class="preview-status"><span class="status-message" id="statusMessage">1å€‹ã®é …ç›®ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™</span></div></div></div><hr class="section-divider">`;const dialogContent=`<h3>ãƒ™ãƒ³ãƒªãã‚“ï¼šãƒšãƒ¼ã‚¸ãƒªãƒ³ã‚¯ä½œæˆ</h3>${titleSelectionSection}<div class="section-title">ãƒªãƒ³ã‚¯ä»˜ãã‚³ãƒ”ãƒ¼ï¼ˆ<span style="font-weight: bold;">Teams</span>ã§<span style="font-weight: bold;">URL</span>å±•é–‹ãŒèµ·ãã‚‹å ´åˆã¯è²¼ã‚Šä»˜ã‘å¾Œã«<span style="font-weight: bold;">Ctrl+Z</span>ã‚’ï¼ï¼‰</div><div class="button-container link-buttons"><button id="htmlLinkButton">ã€Enterã€‘HTML<br>ãƒªãƒ³ã‚¯</button><button id="markdownLinkButton">Markdown<br>ãƒªãƒ³ã‚¯</button></div><div class="section-title">ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ”ãƒ¼</div><div class="button-container text-buttons"><button id="titleOnlyButton">ã‚¿ã‚¤ãƒˆãƒ«<br>ã®ã¿</button><button id="urlOnlyButton">URL<br>ã®ã¿</button><button id="titleUrlButton">ã‚¿ã‚¤ãƒˆãƒ«+URL<br>(ãƒ†ã‚­ã‚¹ãƒˆ)</button></div><button id="closeDialog">é–‰ã˜ã‚‹</button>`;dialog.innerHTML=dialogContent;document.body.appendChild(dialog);return dialog;}function setupGenericPageEventHandlers(dialog){const currentUrl=window.location.href;const pageTitle=document.title.trim()||'Untitled Page';const h1Content=getH1Content();const h2Content=getH2Content();let currentTitle=pageTitle;const updateCardStyles=()=>{const cards=dialog.querySelectorAll('.title-card-horizontal');cards.forEach(card=>{const checkbox=card.querySelector('input[type="checkbox"]');if(checkbox){if(checkbox.checked){card.classList.add('selected');}else{card.classList.remove('selected');}}});};const updateCurrentTitle=()=>{const previewContent=dialog.querySelector('.preview-content-simple');const titlePreview=dialog.querySelector('#titlePreview');const statusMessage=dialog.querySelector('#statusMessage');if(previewContent){previewContent.classList.add('updating');}const titleCheckbox=dialog.querySelector('#titleCheckbox');const h1Checkbox=dialog.querySelector('#h1Checkbox');const h2Checkbox=dialog.querySelector('#h2Checkbox');const selectedTitles=[];let statusText='';if(titleCheckbox&&titleCheckbox.checked){selectedTitles.push(pageTitle);}if(h1Checkbox&&h1Checkbox.checked&&h1Content){selectedTitles.push(h1Content);}if(h2Checkbox&&h2Checkbox.checked&&h2Content){selectedTitles.push(h2Content);}if(selectedTitles.length>0){currentTitle=selectedTitles.join(' | ');statusText=`${selectedTitles.length}å€‹ã®é …ç›®ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™`;if(previewContent){previewContent.classList.remove('fallback-mode');}}else{currentTitle=pageTitle||'Untitled Page';statusText='âš ï¸ ä½•ã‚‚é¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™';if(previewContent){previewContent.classList.add('fallback-mode');}}if(titlePreview){titlePreview.textContent=currentTitle;}if(statusMessage){statusMessage.textContent=statusText;}updateCardStyles();setTimeout(()=>{if(previewContent){previewContent.classList.remove('updating');}},300);};const setupCheckboxListeners=()=>{const titleCheckbox=dialog.querySelector('#titleCheckbox');const h1Checkbox=dialog.querySelector('#h1Checkbox');const h2Checkbox=dialog.querySelector('#h2Checkbox');if(titleCheckbox){titleCheckbox.addEventListener('change',updateCurrentTitle);}if(h1Checkbox){h1Checkbox.addEventListener('change',updateCurrentTitle);}if(h2Checkbox){h2Checkbox.addEventListener('change',updateCurrentTitle);}updateCardStyles();updateCurrentTitle();};const addSafeEventListener=(buttonId,handler)=>{const button=dialog.querySelector(buttonId);if(button){const wrappedHandler=function(event){try{handler.call(this,event);}catch(e){ErrorHandler.logDetailed('error',ErrorHandler.ErrorTypes.UNKNOWN_ERROR,e,`generic button handler: ${buttonId}`);DialogManager.closeAndCleanup(dialog);}};button.addEventListener("click",wrappedHandler,{passive:false,once:true});}};setupCheckboxListeners();addSafeEventListener("#markdownLinkButton",()=>{const markdownText=`[${currentTitle}](${currentUrl})`;ClipboardManager.copyPlainText(markdownText,dialog);});addSafeEventListener("#htmlLinkButton",()=>{const richContent={plainText:`${currentTitle} ${currentUrl}`,html:`<div><a href="${currentUrl}" target="_blank">${currentTitle}</a></div>`};ClipboardManager.copyRichText(richContent.plainText,richContent.html,dialog);});addSafeEventListener("#titleOnlyButton",()=>{ClipboardManager.copyPlainText(currentTitle,dialog);});addSafeEventListener("#urlOnlyButton",()=>{ClipboardManager.copyPlainText(currentUrl,dialog);});addSafeEventListener("#titleUrlButton",()=>{const text=`${currentTitle}\n${currentUrl}`;ClipboardManager.copyPlainText(text,dialog);});const closeButton=dialog.querySelector("#closeDialog");if(closeButton){closeButton.addEventListener("click",function(){DialogManager.closeAndCleanup(dialog);},{once:true});}dialog.addEventListener("click",function(event){if(event.target===dialog){DialogManager.closeAndCleanup(dialog);}},{once:true});dialog.addEventListener("keydown",function(event){if(event.key==="Enter"){event.preventDefault();const htmlLinkButton=dialog.querySelector("#htmlLinkButton");if(htmlLinkButton){htmlLinkButton.click();}}},{once:true});}const CSS_STYLES=`dialog[data-spo-bookmarklet="true"]{all:initial !important;position:fixed !important;top:50% !important;left:50% !important;transform:translate(-50%,-50%) scale(1.05) !important;opacity:0 !important;z-index:2147483647 !important;isolation:isolate !important;contain:style layout paint !important;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif !important;box-sizing:border-box !important;border:none !important;border-radius:8px !important;box-shadow:0 8px 32px rgba(0,0,0,0.15) !important;background:linear-gradient(145deg,#ffffff 0%,#f8fafc 100%) !important;border:1px solid #e2e8f0 !important;padding:14px 14px 14px 14px !important;width:${CONFIG.ui.dialogWidth} !important;height:auto !important;min-height:500px !important;max-height:95vh !important;overflow-y:auto !important;transition:transform 0.3s cubic-bezier(0.4,0,0.2,1),opacity 0.3s ease !important;display:flex !important;flex-direction:column !important;justify-content:flex-start !important}dialog[data-spo-bookmarklet="true"][open]{transform:translate(-50%,-50%) scale(1) !important;opacity:1 !important}dialog[data-spo-bookmarklet="true"] *{all:unset !important;box-sizing:border-box !important;display:revert !important;font-family:inherit !important}dialog[data-spo-bookmarklet="true"] h3{display:block !important;margin:0 0 10px !important;font-size:18px !important;font-weight:600 !important;color:#2d3748 !important;text-align:center !important;flex-shrink:0 !important}dialog[data-spo-bookmarklet="true"] .content-section{display:block !important;margin-bottom:8px !important;background-color:#f8f9fa !important;border:1px solid #e2e8f0 !important;border-radius:6px !important;padding:10px !important;flex-shrink:0 !important}dialog[data-spo-bookmarklet="true"] .folder-info{display:block !important;margin:0 !important;font-size:14px !important;font-weight:500 !important;color:#495057 !important}dialog[data-spo-bookmarklet="true"] .folder-info a{color:#007acc !important;text-decoration:none !important;cursor:pointer !important}dialog[data-spo-bookmarklet="true"] .folder-info a:hover{color:#0056b3 !important;text-decoration:underline !important}dialog[data-spo-bookmarklet="true"] .title-selection-container{display:block !important;background-color:#f9fafb !important;border:1px solid #e2e8f0 !important;border-radius:6px !important;padding:10px !important;margin-bottom:8px !important;flex-shrink:0 !important}dialog[data-spo-bookmarklet="true"] .title-option{display:block !important;margin-bottom:8px !important}dialog[data-spo-bookmarklet="true"] .title-option:last-child{margin-bottom:0 !important}dialog[data-spo-bookmarklet="true"] .title-checkbox-label{display:flex !important;align-items:flex-start !important;cursor:pointer !important;font-size:13px !important;line-height:1.4 !important;color:#2d3748 !important}dialog[data-spo-bookmarklet="true"] .title-checkbox-label input[type="checkbox"]{margin-right:8px !important;margin-top:2px !important;flex-shrink:0 !important;cursor:pointer !important}dialog[data-spo-bookmarklet="true"] .title-checkbox-label input[type="checkbox"]:disabled{cursor:not-allowed !important;opacity:0.5 !important}dialog[data-spo-bookmarklet="true"] .title-checkbox-label input[type="checkbox"]:disabled + strong,dialog[data-spo-bookmarklet="true"] .title-checkbox-label input[type="checkbox"]:disabled ~ .title-content{opacity:0.5 !important;color:#9aa0a6 !important}dialog[data-spo-bookmarklet="true"] .title-content{color:#4a5568 !important;font-weight:normal !important;word-break:break-word !important}dialog[data-spo-bookmarklet="true"] .step-container{display:block !important;margin-bottom:12px !important;flex-shrink:0 !important}dialog[data-spo-bookmarklet="true"] .step-header{display:block !important;font-size:13px !important;font-weight:600 !important;color:#495057 !important;margin-bottom:8px !important;padding:6px 8px !important;background-color:#f8f9fa !important;border:1px solid #dee2e6 !important;border-radius:4px !important;text-align:center !important;letter-spacing:0.3px !important}dialog[data-spo-bookmarklet="true"] .title-preview{display:block !important;background-color:#f0f9ff !important;border:2px solid #3b82f6 !important;border-radius:6px !important;padding:12px !important;font-size:14px !important;font-weight:500 !important;color:#1e40af !important;text-align:center !important;margin:0 !important;word-break:break-word !important;line-height:1.4 !important}dialog[data-spo-bookmarklet="true"] .title-preview span{color:#1e40af !important;font-weight:600 !important}dialog[data-spo-bookmarklet="true"] .title-preview-gentle{display:block !important;background-color:#f8f9fa !important;border:1px solid #dee2e6 !important;border-radius:6px !important;padding:12px 16px !important;font-size:14px !important;color:#495057 !important;font-weight:500 !important;text-align:left !important;margin:0 !important;word-break:break-word !important;line-height:1.4 !important;transition:background-color 0.3s ease !important}dialog[data-spo-bookmarklet="true"] .title-preview-gentle span{color:#495057 !important;font-weight:500 !important}dialog[data-spo-bookmarklet="true"] .title-selection-guide{font-size:12px !important;color:#6b7280 !important;text-align:center !important;margin-bottom:12px !important;font-style:italic !important}dialog[data-spo-bookmarklet="true"] .title-cards-container-horizontal{display:flex !important;flex-direction:column !important;gap:4px !important;margin:0 !important}dialog[data-spo-bookmarklet="true"] .title-card-horizontal{border:2px solid #e5e7eb !important;border-radius:8px !important;padding:8px !important;margin:0 !important;background:linear-gradient(145deg,#ffffff 0%,#f9fafb 100%) !important;transition:all 0.3s cubic-bezier(0.4,0,0.2,1) !important;cursor:pointer !important;position:relative !important}dialog[data-spo-bookmarklet="true"] .title-card-horizontal:hover{border-color:#3b82f6 !important;background:linear-gradient(145deg,#f8fafc 0%,#f1f5f9 100%) !important;box-shadow:0 4px 12px rgba(59,130,246,0.1) !important}dialog[data-spo-bookmarklet="true"] .title-card-horizontal.selected{border-color:#059669 !important;background:linear-gradient(145deg,#f0fdf4 0%,#dcfce7 100%) !important;box-shadow:0 4px 12px rgba(5,150,105,0.15) !important}dialog[data-spo-bookmarklet="true"] .title-card-label-horizontal{display:grid !important;grid-template-columns:40px 40px 120px 1fr !important;grid-template-areas:"checkbox icon label content" !important;align-items:center !important;gap:8px !important;cursor:pointer !important;width:100% !important;min-height:32px !important}dialog[data-spo-bookmarklet="true"] .card-checkbox-area{grid-area:checkbox !important;display:flex !important;justify-content:center !important;align-items:center !important}dialog[data-spo-bookmarklet="true"] .card-icon-area{grid-area:icon !important;display:flex !important;justify-content:center !important;align-items:center !important}dialog[data-spo-bookmarklet="true"] .card-label-area{grid-area:label !important;display:flex !important;align-items:center !important}dialog[data-spo-bookmarklet="true"] .card-content-area{grid-area:content !important;display:flex !important;align-items:center !important;overflow:hidden !important}dialog[data-spo-bookmarklet="true"] .title-card-horizontal input[type="checkbox"]{display:none !important}dialog[data-spo-bookmarklet="true"] .selection-indicator-horizontal{font-size:18px !important;color:#d1d5db !important;transition:all 0.3s ease !important;font-weight:bold !important}dialog[data-spo-bookmarklet="true"] .title-card-horizontal.selected .selection-indicator-horizontal{color:#059669 !important;transform:scale(1.1) !important}dialog[data-spo-bookmarklet="true"] .card-icon-horizontal{font-size:20px !important;line-height:1 !important}dialog[data-spo-bookmarklet="true"] .card-title-horizontal{font-size:13px !important;font-weight:600 !important;color:#1f2937 !important;white-space:nowrap !important}dialog[data-spo-bookmarklet="true"] .card-content-horizontal{font-size:12px !important;color:#374151 !important;line-height:1.3 !important;word-break:break-word !important;background-color:rgba(255,255,255,0.7) !important;padding:4px 8px !important;border-radius:4px !important;border-left:3px solid #e5e7eb !important;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important}dialog[data-spo-bookmarklet="true"] .title-card-horizontal.selected .card-content-horizontal{border-left-color:#059669 !important;background-color:rgba(255,255,255,0.9) !important}dialog[data-spo-bookmarklet="true"] .preview-description-unified{font-size:11px !important;color:#6b7280 !important;text-align:center !important;margin-bottom:12px !important;font-style:italic !important}dialog[data-spo-bookmarklet="true"] .title-preview-modern-simple{background:linear-gradient(145deg,#f8fafc 0%,#f1f5f9 100%) !important;border:2px solid #cbd5e1 !important;border-radius:8px !important;padding:12px !important;margin:0 !important;position:relative !important}dialog[data-spo-bookmarklet="true"] .preview-content-simple{background-color:white !important;border:1px solid #e2e8f0 !important;border-radius:6px !important;padding:10px 14px !important;font-size:14px !important;color:#1f2937 !important;font-weight:600 !important;text-align:center !important;min-height:20px !important;display:flex !important;align-items:center !important;justify-content:center !important;transition:all 0.3s ease !important}dialog[data-spo-bookmarklet="true"] .preview-content-simple.updating{background-color:#fef3c7 !important;border-color:#f59e0b !important;transform:scale(1.01) !important}dialog[data-spo-bookmarklet="true"] .preview-content-simple.fallback-mode{border-color:#f59e0b !important;background-color:#fef3c7 !important}dialog[data-spo-bookmarklet="true"] .preview-status{margin-top:8px !important;text-align:center !important}dialog[data-spo-bookmarklet="true"] .status-message{font-size:10px !important;color:#6b7280 !important;font-style:italic !important;padding:4px 8px !important;background-color:#f9fafb !important;border-radius:4px !important;display:inline-block !important}dialog[data-spo-bookmarklet="true"] .fallback-mode + .preview-status .status-message{color:#d97706 !important;background-color:#fef3c7 !important;border:1px solid #f59e0b !important}dialog[data-spo-bookmarklet="true"] .modern-card{border:2px solid #e5e7eb !important;border-radius:12px !important;padding:16px !important;margin-bottom:8px !important;background:linear-gradient(145deg,#ffffff 0%,#f9fafb 100%) !important;transition:all 0.3s cubic-bezier(0.4,0,0.2,1) !important;cursor:pointer !important;position:relative !important;overflow:hidden !important}dialog[data-spo-bookmarklet="true"] .modern-card::before{content:'' !important;position:absolute !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;background:linear-gradient(135deg,rgba(59,130,246,0.05) 0%,rgba(147,51,234,0.05) 100%) !important;opacity:0 !important;transition:opacity 0.3s ease !important;pointer-events:none !important}dialog[data-spo-bookmarklet="true"] .modern-card:hover::before{opacity:1 !important}dialog[data-spo-bookmarklet="true"] .modern-card:hover{border-color:#3b82f6 !important;transform:translateY(-2px) !important;box-shadow:0 8px 25px rgba(59,130,246,0.15) !important}dialog[data-spo-bookmarklet="true"] .modern-card.selected{border-color:#059669 !important;background:linear-gradient(145deg,#f0fdf4 0%,#dcfce7 100%) !important;box-shadow:0 4px 20px rgba(5,150,105,0.2) !important}dialog[data-spo-bookmarklet="true"] .modern-card.selected::before{background:linear-gradient(135deg,rgba(5,150,105,0.1) 0%,rgba(34,197,94,0.1) 100%) !important;opacity:1 !important}dialog[data-spo-bookmarklet="true"] .card-visual{display:flex !important;align-items:flex-start !important;gap:12px !important}dialog[data-spo-bookmarklet="true"] .card-icon{font-size:24px !important;line-height:1 !important;flex-shrink:0 !important;margin-top:2px !important}dialog[data-spo-bookmarklet="true"] .card-info{flex:1 !important}dialog[data-spo-bookmarklet="true"] .card-title{font-size:14px !important;font-weight:700 !important;color:#1f2937 !important;margin-bottom:2px !important}dialog[data-spo-bookmarklet="true"] .card-description{font-size:11px !important;color:#6b7280 !important;margin-bottom:6px !important;font-style:italic !important}dialog[data-spo-bookmarklet="true"] .card-content{font-size:12px !important;color:#374151 !important;line-height:1.4 !important;word-break:break-word !important;background-color:rgba(255,255,255,0.6) !important;padding:6px 8px !important;border-radius:4px !important;border-left:3px solid #e5e7eb !important}dialog[data-spo-bookmarklet="true"] .modern-card.selected .card-content{border-left-color:#059669 !important;background-color:rgba(255,255,255,0.8) !important}dialog[data-spo-bookmarklet="true"] .modern-card input[type="checkbox"]{display:none !important}dialog[data-spo-bookmarklet="true"] .selection-indicator{font-size:18px !important;color:#d1d5db !important;transition:all 0.3s ease !important;align-self:flex-start !important;margin-top:2px !important}dialog[data-spo-bookmarklet="true"] .modern-card.selected .selection-indicator{color:#059669 !important;transform:scale(1.2) !important}dialog[data-spo-bookmarklet="true"] .preview-description{font-size:11px !important;color:#6b7280 !important;text-align:center !important;margin-bottom:12px !important;font-style:italic !important}dialog[data-spo-bookmarklet="true"] .title-preview-modern{background:linear-gradient(145deg,#f8fafc 0%,#f1f5f9 100%) !important;border:2px solid #cbd5e1 !important;border-radius:12px !important;padding:16px !important;margin:0 !important;position:relative !important;overflow:hidden !important}dialog[data-spo-bookmarklet="true"] .title-preview-modern::before{content:'' !important;position:absolute !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;background:linear-gradient(90deg,rgba(59,130,246,0.1) 0%,rgba(147,51,234,0.1) 50%,rgba(59,130,246,0.1) 100%) !important;animation:shimmer 3s linear infinite !important;pointer-events:none !important}@keyframes shimmer{0%{transform:translateX(-100%) !important}100%{transform:translateX(100%) !important}}dialog[data-spo-bookmarklet="true"] .preview-label{display:flex !important;align-items:center !important;justify-content:center !important;gap:6px !important;margin-bottom:8px !important;font-size:11px !important;color:#4b5563 !important;font-weight:600 !important}dialog[data-spo-bookmarklet="true"] .preview-icon{animation:bounce 2s infinite !important}@keyframes bounce{0%,20%,50%,80%,100%{transform:translateY(0) !important}40%{transform:translateY(-4px) !important}60%{transform:translateY(-2px) !important}}dialog[data-spo-bookmarklet="true"] .preview-content{background-color:white !important;border:1px solid #e2e8f0 !important;border-radius:8px !important;padding:12px 16px !important;font-size:14px !important;color:#1f2937 !important;font-weight:600 !important;text-align:center !important;min-height:24px !important;display:flex !important;align-items:center !important;justify-content:center !important;position:relative !important;transition:all 0.3s ease !important}dialog[data-spo-bookmarklet="true"] .preview-content.updating{background-color:#fef3c7 !important;border-color:#f59e0b !important;transform:scale(1.02) !important}dialog[data-spo-bookmarklet="true"] .preview-indicator{position:absolute !important;top:8px !important;right:8px !important;display:flex !important;align-items:center !important;gap:4px !important}dialog[data-spo-bookmarklet="true"] .live-indicator{width:8px !important;height:8px !important;background-color:#ef4444 !important;border-radius:50% !important;animation:pulse 1.5s infinite !important}@keyframes pulse{0%{opacity:1 !important;transform:scale(1) !important}50%{opacity:0.5 !important;transform:scale(1.2) !important}100%{opacity:1 !important;transform:scale(1) !important}}dialog[data-spo-bookmarklet="true"] .live-text{font-size:9px !important;color:#ef4444 !important;font-weight:700 !important;letter-spacing:0.5px !important}dialog[data-spo-bookmarklet="true"] .title-cards-container{display:grid !important;grid-template-columns:1fr !important;gap:8px !important;margin:0 !important}dialog[data-spo-bookmarklet="true"] .title-card{display:block !important;border:2px solid #e2e8f0 !important;border-radius:8px !important;padding:12px !important;margin:0 !important;cursor:pointer !important;transition:all 0.2s ease !important;background:#ffffff !important;position:relative !important}dialog[data-spo-bookmarklet="true"] .title-card:hover{border-color:#94a3b8 !important;background-color:#f8fafc !important}dialog[data-spo-bookmarklet="true"] .title-card.selected{border-color:#059669 !important;background-color:#f0fdf4 !important;box-shadow:0 2px 4px rgba(5, 150, 105, 0.1) !important}dialog[data-spo-bookmarklet="true"] .title-card-label{display:flex !important;align-items:flex-start !important;cursor:pointer !important;font-size:13px !important;line-height:1.4 !important;color:#2d3748 !important;width:100% !important}dialog[data-spo-bookmarklet="true"] .title-card-label input[type="checkbox"]{width:18px !important;height:18px !important;accent-color:#059669 !important;margin-right:12px !important;margin-top:1px !important;flex-shrink:0 !important;cursor:pointer !important}dialog[data-spo-bookmarklet="true"] .card-content{flex:1 !important}dialog[data-spo-bookmarklet="true"] .card-title{font-weight:700 !important;color:#374151 !important;margin-bottom:4px !important;font-size:12px !important;text-transform:uppercase !important;letter-spacing:0.5px !important}dialog[data-spo-bookmarklet="true"] .card-text{color:#6b7280 !important;font-weight:normal !important;word-break:break-word !important;font-size:13px !important;line-height:1.3 !important}dialog[data-spo-bookmarklet="true"] .hierarchical-path{display:block !important;background-color:#f9fafb !important;border:1px solid #e2e8f0 !important;border-radius:6px !important;padding:10px !important;margin-bottom:8px !important;max-height:calc(1.3em * 3 + 20px) !important;overflow-y:auto !important;flex-shrink:0 !important}dialog[data-spo-bookmarklet="true"] .path-title{display:block !important;font-weight:600 !important;color:#2d3748 !important;margin-bottom:4px !important;font-size:12px !important}dialog[data-spo-bookmarklet="true"] .path-tree{display:block !important;font-family:inherit !important;font-size:11px !important;color:#4a5568 !important;line-height:1.3 !important;white-space:normal !important;word-wrap:normal !important;overflow-x:auto !important}dialog[data-spo-bookmarklet="true"] .section-divider{display:block !important;margin:6px 0 !important;border:none !important;border-top:1px solid #e2e8f0 !important;flex-shrink:0 !important;height:1px !important}dialog[data-spo-bookmarklet="true"] .section-title{display:block !important;font-size:12px !important;font-weight:700 !important;color:#2d3748 !important;text-align:center !important;margin:4px 0 6px !important;padding:2px 0 !important;background-color:transparent !important;border:none !important;flex-shrink:0 !important;text-transform:uppercase !important;letter-spacing:0.4px !important}dialog[data-spo-bookmarklet="true"] .section-title span{text-transform:none !important}dialog[data-spo-bookmarklet="true"] .button-container{display:grid !important;gap:3px !important;margin-bottom:6px !important;flex-shrink:0 !important}dialog[data-spo-bookmarklet="true"] .button-container.link-buttons{grid-template-columns:repeat(2,1fr) !important;grid-auto-rows:auto !important;grid-gap:3px !important}dialog[data-spo-bookmarklet="true"] .button-container.text-buttons{grid-template-columns:repeat(3,1fr) !important}dialog[data-spo-bookmarklet="true"] .button-container.text-buttons:last-of-type{margin-bottom:8px !important}dialog[data-spo-bookmarklet="true"] button{display:flex !important;align-items:center !important;justify-content:center !important;background:#f1f3f4 !important;color:#5f6368 !important;border:1px solid #dadce0 !important;border-radius:4px !important;padding:8px 16px !important;font-size:13px !important;font-weight:500 !important;letter-spacing:0.1px !important;box-shadow:none !important;transition:background-color 0.2s ease,border-color 0.2s ease !important;cursor:pointer !important;position:relative !important;overflow:visible !important;min-height:36px !important;white-space:normal !important;line-height:1.2 !important;text-align:center !important;user-select:none !important;-webkit-user-select:none !important;-moz-user-select:none !important;-ms-user-select:none !important;transform:none !important}dialog[data-spo-bookmarklet="true"] button:hover{background:#e8eaed !important;border-color:#c4c7ca !important;transform:none !important;box-shadow:none !important}dialog[data-spo-bookmarklet="true"] button:active{background:#e0e3e6 !important;border-color:#b8bcc0 !important;transform:none !important;box-shadow:none !important;transition:all 0.1s !important}dialog[data-spo-bookmarklet="true"] button:focus-visible{outline:2px solid #4285f4 !important;outline-offset:1px !important;box-shadow:none !important}dialog[data-spo-bookmarklet="true"] button:disabled{background:#f8f9fa !important;color:#9aa0a6 !important;border-color:#f1f3f4 !important;cursor:not-allowed !important}dialog[data-spo-bookmarklet="true"] button::before{display:none !important}dialog[data-spo-bookmarklet="true"] .debug-info{display:block !important;font-size:9px !important;color:#6b7280 !important;margin-top:0 !important;margin-bottom:8px !important;padding:6px 8px !important;background-color:#f8f9fa !important;border:1px solid #e1e5e9 !important;border-radius:4px !important;max-height:50px !important;overflow-y:auto !important;flex-shrink:1 !important;white-space:normal !important;word-wrap:break-word !important;line-height:1.3 !important;min-height:25px !important}dialog[data-spo-bookmarklet="true"] #closeDialog{display:flex !important;align-items:center !important;justify-content:center !important;width:100% !important;margin-top:0 !important;margin-bottom:0 !important;background:#f1f3f4 !important;color:#5f6368 !important;border:1px solid #dadce0 !important;border-radius:4px !important;font-weight:500 !important;z-index:2 !important;flex-shrink:0 !important;box-shadow:none !important;transform:none !important;padding:8px 16px !important;font-size:13px !important;min-height:36px !important}dialog[data-spo-bookmarklet="true"] #closeDialog:hover{background:#e8eaed !important;border-color:#c4c7ca !important;transform:none !important;box-shadow:none !important}dialog[data-spo-bookmarklet="true"] #closeDialog:active{background:#e0e3e6 !important;border-color:#b8bcc0 !important;transform:none !important;box-shadow:none !important}[data-spo-message="true"]{position:fixed !important;top:20px !important;right:20px !important;background:linear-gradient(135deg,#059669 0%,#047857 100%) !important;color:white !important;padding:12px 18px !important;border-radius:8px !important;box-shadow:0 6px 20px rgba(5,150,105,0.3) !important;opacity:0 !important;transition:all 0.3s cubic-bezier(0.4,0,0.2,1) !important;transform:translateY(-10px) !important;font-weight:500 !important;z-index:2147483648 !important;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif !important;font-size:14px !important;pointer-events:none !important}[data-spo-message="true"].show{opacity:1 !important;transform:translateY(0) !important}dialog[data-spo-bookmarklet="true"] #fileList{display:block !important;background-color:#f9fafb !important;border:1px solid #e2e8f0 !important;border-left:4px solid #6b7280 !important;border-radius:6px !important;padding:10px 8px 8px 18px !important;margin:0 !important;font-family:inherit !important;line-height:1.3 !important;max-height:calc(1.3em * 3 + 20px) !important;overflow-y:auto !important;flex-shrink:0 !important;position:relative !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item{display:block !important;margin-bottom:3px !important;padding:2px 0 !important;color:#000000 !important;font-size:12px !important;background-color:transparent !important;border:none !important;border-radius:0 !important;font-weight:normal !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item:last-child{margin-bottom:0 !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item:before{content:'â€¢ ' !important;color:#6b7280 !important;font-weight:bold !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item.folder:before{content:'ğŸ“ ' !important;color:#6b7280 !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item.word:before{content:'ğŸ“ ' !important;color:#6b7280 !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item.excel:before{content:'ğŸ“Š ' !important;color:#6b7280 !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item.powerpoint:before{content:'ğŸ“‹ ' !important;color:#6b7280 !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item.pdf:before{content:'ğŸ“„ ' !important;color:#6b7280 !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item.image:before{content:'ğŸ–¼ï¸ ' !important;color:#6b7280 !important}dialog[data-spo-bookmarklet="true"] #fileList .file-item.file:before{content:'ğŸ“„ ' !important;color:#6b7280 !important}@media (max-width:768px){dialog[data-spo-bookmarklet="true"] .title-card-label-horizontal{grid-template-columns:35px 35px 100px 1fr !important;gap:6px !important}dialog[data-spo-bookmarklet="true"] .card-title-horizontal{font-size:12px !important}dialog[data-spo-bookmarklet="true"] .card-content-horizontal{font-size:11px !important}}@media (max-width:480px){dialog[data-spo-bookmarklet="true"] .title-card-label-horizontal{grid-template-columns:30px 30px 80px 1fr !important;gap:4px !important}dialog[data-spo-bookmarklet="true"] .title-card-horizontal{padding:6px !important}dialog[data-spo-bookmarklet="true"] .card-title-horizontal{font-size:11px !important}}@media (min-height:800px){dialog[data-spo-bookmarklet="true"]{max-height:90vh !important;min-height:450px !important}}@media (max-height:700px){dialog[data-spo-bookmarklet="true"]{min-height:95vh !important;max-height:95vh !important;padding:10px 10px 10px 10px !important}dialog[data-spo-bookmarklet="true"] button{min-height:32px !important;padding:6px 12px !important;font-size:12px !important}dialog[data-spo-bookmarklet="true"] #closeDialog{min-height:32px !important;padding:6px 12px !important;font-size:12px !important}dialog[data-spo-bookmarklet="true"] .content-section{padding:8px !important;margin-bottom:6px !important}dialog[data-spo-bookmarklet="true"] .section-title{font-size:11px !important;margin:3px 0 5px !important}dialog[data-spo-bookmarklet="true"] .debug-info{font-size:8px !important;max-height:35px !important;padding:4px 6px !important}}@media (max-height:600px){dialog[data-spo-bookmarklet="true"]{min-height:98vh !important;max-height:98vh !important;padding:8px 8px 8px 8px !important}dialog[data-spo-bookmarklet="true"] button{min-height:28px !important;padding:4px 10px !important;font-size:11px !important}dialog[data-spo-bookmarklet="true"] #closeDialog{min-height:28px !important;padding:4px 10px !important;font-size:11px !important}dialog[data-spo-bookmarklet="true"] .section-title{font-size:10px !important;margin:2px 0 4px !important}dialog[data-spo-bookmarklet="true"] #fileList{max-height:calc(1.3em * 2 + 16px) !important}dialog[data-spo-bookmarklet="true"] .hierarchical-path{max-height:calc(1.3em * 2 + 16px) !important}dialog[data-spo-bookmarklet="true"] .debug-info{font-size:7px !important;max-height:25px !important;padding:3px 5px !important;line-height:1.2 !important}}@media (max-width:768px){dialog[data-spo-bookmarklet="true"]{width:95vw !important}dialog[data-spo-bookmarklet="true"] .button-container.link-buttons{grid-template-columns:repeat(2,1fr) !important}dialog[data-spo-bookmarklet="true"] .button-container.text-buttons{grid-template-columns:repeat(2,1fr) !important}dialog[data-spo-bookmarklet="true"] button{font-size:12px !important;padding:7px 14px !important;min-height:38px !important}dialog[data-spo-bookmarklet="true"] #closeDialog{font-size:12px !important;padding:7px 14px !important;min-height:38px !important}dialog[data-spo-bookmarklet="true"] .title-cards-container{grid-template-columns:1fr !important;gap:6px !important}}@media (max-width:480px){dialog[data-spo-bookmarklet="true"]{width:98vw !important;padding:10px 10px 10px 10px !important}dialog[data-spo-bookmarklet="true"] .button-container.link-buttons{grid-template-columns:repeat(2,1fr) !important}dialog[data-spo-bookmarklet="true"] .button-container.text-buttons{grid-template-columns:1fr !important}dialog[data-spo-bookmarklet="true"] button{font-size:12px !important;padding:8px 12px !important;min-height:40px !important}dialog[data-spo-bookmarklet="true"] #closeDialog{font-size:12px !important;padding:8px 12px !important;min-height:40px !important}dialog[data-spo-bookmarklet="true"] #fileList{max-height:calc(1.3em * 2 + 12px) !important}dialog[data-spo-bookmarklet="true"] .hierarchical-path{max-height:calc(1.3em * 2 + 12px) !important}dialog[data-spo-bookmarklet="true"] .title-cards-container{grid-template-columns:1fr !important}}@media (max-width:400px){dialog[data-spo-bookmarklet="true"] .section-title{font-size:9px !important}dialog[data-spo-bookmarklet="true"] button{font-size:11px !important;padding:7px 10px !important;min-height:36px !important}dialog[data-spo-bookmarklet="true"] #closeDialog{font-size:11px !important;padding:7px 10px !important;min-height:36px !important}dialog[data-spo-bookmarklet="true"] .button-container.link-buttons{grid-template-columns:1fr !important}dialog[data-spo-bookmarklet="true"] .title-cards-container{grid-template-columns:1fr !important}}`;function buildOptimalFolderUrl(){try{const convertToSharePointFormat=(originalUrl)=>{try{const url=new URL(originalUrl);const pathMatch=url.pathname.match(/^(\/sites\/[^\/]+\/[^\/]+)(\/.*)?$/);if(pathMatch){const basePath=pathMatch[1];const folderPath=pathMatch[2]||'';if(folderPath&&folderPath!=='/'&&folderPath.trim().length>0){const cleanPath=folderPath.startsWith('/')?folderPath.substring(1):folderPath;if(cleanPath.length>0){try{const decodedPath=decodeURIComponent(cleanPath);const pathSegments=decodedPath.split('/');const encodedSegments=pathSegments.map(segment=>segment?encodeURIComponent(segment):'');const safePath=encodedSegments.join('/');return `${url.origin}/:f:/r${basePath}/${safePath}?csf=1&web=1`;}catch(decodeError){const pathSegments=cleanPath.split('/');const encodedSegments=pathSegments.map(segment=>segment?encodeURIComponent(segment):'');const safePath=encodedSegments.join('/');return `${url.origin}/:f:/r${basePath}/${safePath}?csf=1&web=1`;}}}}return originalUrl;}catch(e){ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.URL_ERROR,e,'SharePoint format conversion');return originalUrl;}};const breadcrumbElements=document.querySelectorAll('[data-item-key*="/sites/"]');let deepestPath='';let maxDepth=0;for(const element of breadcrumbElements){try{const dataItemKey=element.getAttribute('data-item-key');if(dataItemKey){const parsedData=JSON.parse(dataItemKey.replace(/&quot;/g,'"'));const currentPath=parsedData[4]||'';if(currentPath.trim()){const depth=currentPath.split('/').length;if(depth>maxDepth){maxDepth=depth;deepestPath=currentPath;}}}}catch(e){continue;}}if(deepestPath){const originalUrl=window.location.origin+deepestPath;return convertToSharePointFormat(originalUrl);}const url=new URL(window.location.href);const idParam=url.searchParams.get('id');if(idParam){const decodedPath=decodeURIComponent(idParam);if(decodedPath.startsWith('/sites/')){const originalUrl=window.location.origin+decodedPath;return convertToSharePointFormat(originalUrl);}}const originalUrl=window.location.href;return convertToSharePointFormat(originalUrl);}catch(error){ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.URL_ERROR,error,'optimal folder URL building');return window.location.href;}}const Utils={async waitForElement(selector,timeout=CONFIG.ui.elementTimeout){const cached=PerformanceOptimizer.getCachedResult(selector);if(cached){return cached;}return new Promise((resolve)=>{const existingElement=document.querySelector(selector);if(existingElement){PerformanceOptimizer.setCachedResult(selector,existingElement);resolve(existingElement);return;}let timeoutId;const observer=new MutationObserver(()=>{const element=document.querySelector(selector);if(element){observer.disconnect();clearTimeout(timeoutId);PerformanceOptimizer.setCachedResult(selector,element);resolve(element);}});observer.observe(document.body,{childList:true,subtree:true});timeoutId=setTimeout(()=>{observer.disconnect();resolve(null);},timeout);});},async findElementBySelectors(selectors){try{const result=await PerformanceOptimizer.parallelSearch(selectors,'querySelector');if(result){return result;}}catch(e){console.warn('æœ€é©åŒ–æ¤œç´¢å¤±æ•—ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè¡Œ:',e);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,e,'optimized selector search');}for(const selector of selectors){try{const element=document.querySelector(selector);if(element)return element;}catch(e){console.warn('ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã‚¨ãƒ©ãƒ¼:',selector,e);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,e,`selector: ${selector}`);}}return null;},isExcludedText(text){return!text||text.trim().length===0||CONFIG.excludePatterns.test(text.trim());},isTopLevelFolder(folderName,breadcrumbPath){if(!folderName)return false;if(CONFIG.topLevelFolderPatterns.test(folderName))return true;if(!breadcrumbPath||breadcrumbPath.trim().length===0)return true;const pathParts=breadcrumbPath.split(' > ').filter(Boolean);return pathParts.length<=1;},safeDecodeURIComponent(str){try{return decodeURIComponent(str);}catch(e){console.warn('URL ãƒ‡ã‚³ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:',str,e);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.URL_ERROR,e,`decoding: ${str}`);return str;}},normalizeLibraryName(libraryName){if(!libraryName)return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';const decoded=this.safeDecodeURIComponent(libraryName);const libraryMap={'Shared Documents':'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ','Documents':'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ','Shared Documents':'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ','ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ':'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ','Lists':'ãƒªã‚¹ãƒˆ','Forms':'ãƒ•ã‚©ãƒ¼ãƒ ','ãƒªã‚¹ãƒˆ':'ãƒªã‚¹ãƒˆ','ãƒ•ã‚©ãƒ¼ãƒ ':'ãƒ•ã‚©ãƒ¼ãƒ '};return libraryMap[decoded]||libraryMap[libraryName]||decoded;},parseSharePointPath(path){if(!path)return null;try{const pathParts=path.split('/').filter(Boolean);const sitesIndex=pathParts.findIndex(part=>part==='sites'||part==='teams');if(sitesIndex===-1)return null;const libraryPatterns=['Shared Documents','Documents','ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ','Shared Documents','Lists','Forms'];const libraryIndex=pathParts.findIndex(part=>libraryPatterns.some(pattern=>part===pattern||this.safeDecodeURIComponent(part)===pattern));if(libraryIndex===-1)return null;const folderParts=pathParts.slice(libraryIndex+1);if(folderParts.length===0)return null;const libraryName=this.normalizeLibraryName(pathParts[libraryIndex]);return[libraryName,...folderParts.map(part=>this.safeDecodeURIComponent(part))].join(' > ');}catch(e){console.warn('SharePointãƒ‘ã‚¹è§£æã‚¨ãƒ©ãƒ¼:',e);return null;}},extractSiteNameFromTitle(){const title=document.title;if(!title)return null;try{const bracketMatch=title.match(/^(\[[^\]]+\][^-]+?)(?:\s*-|$)/);if(bracketMatch&&this.isValidSiteName(bracketMatch[1].trim())){return bracketMatch[1].trim();}const parts=title.split(' - ');if(parts.length>=2&&this.isValidSiteName(parts[0].trim())){return parts[0].trim();}if(this.isValidSiteName(title.trim())){return title.trim();}}catch(e){console.warn('ã‚¿ã‚¤ãƒˆãƒ«è§£æã‚¨ãƒ©ãƒ¼:',e);}return null;},extractSiteName(){try{const title=document.title;if(title){const bracketMatch=title.match(/^\[([^\]]+)\](.+?)(?:\s*-|$)/);if(bracketMatch){const siteName=bracketMatch[2].trim();if(siteName&&this.isValidSiteName(siteName)){return siteName;}}const parts=title.split(' - ');if(parts.length>=2){const sitePart=parts[0].trim();if(sitePart&&this.isValidSiteName(sitePart)){return sitePart;}}const cleanTitle=title.trim();if(this.isValidSiteName(cleanTitle)){return cleanTitle;}}const siteNameSelectors=['[data-automation-id="SiteHeader"] [role="heading"]','[data-automation-id="SiteHeader"] h1','.ms-siteHeader-siteName','[data-automationid="SiteName"]','[data-automation-id="siteName"]','.od-TopBar-siteName','[role="banner"] h1'];for(const selector of siteNameSelectors){try{const element=document.querySelector(selector);if(element&&element.textContent){const siteName=element.textContent.trim();if(siteName&&this.isValidSiteName(siteName)){return siteName;}}}catch(e){continue;}}const url=window.location.href;const siteMatch=url.match(/\/sites\/([^\/]+)/);if(siteMatch){return Utils.safeDecodeURIComponent(siteMatch[1]);}}catch(e){console.warn('ã‚µã‚¤ãƒˆåå–å¾—ã‚¨ãƒ©ãƒ¼:',e);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,e,'site name extraction');}return null;},isValidSiteName(siteName){if(!siteName||siteName.length===0)return false;const excludePatterns=[/^SharePoint$/i,/^Microsoft/i,/^ã™ã¹ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ$/i,/^All Documents$/i,/^Documents$/i,/^ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ$/i,/^Home$/i,/^ãƒ›ãƒ¼ãƒ $/i];return!excludePatterns.some(pattern=>pattern.test(siteName.trim()));},detectLibraryNameFromBreadcrumb(){try{const breadcrumbElements=document.querySelectorAll('[data-automationid="breadcrumb-crumb"]');if(breadcrumbElements.length>0){const firstBreadcrumb=breadcrumbElements[0].textContent.trim();if(!this.isExcludedText(firstBreadcrumb)){return firstBreadcrumb;}}}catch(e){console.warn('ãƒ–ãƒ¬ãƒƒãƒ‰ã‚¯ãƒ©ãƒ ã‹ã‚‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªåå–å¾—ã‚¨ãƒ©ãƒ¼:',e);}return null;},detectLibraryName(){try{const breadcrumbLibrary=this.detectLibraryNameFromBreadcrumb();if(breadcrumbLibrary){return breadcrumbLibrary;}const url=window.location.href;if(url.includes('/Shared Documents')||url.includes('/Shared Documents')){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}if(url.includes('/Documents')){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}if(url.includes('/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ')||url.includes('/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ')){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}if(url.includes('/Lists/')){return'ãƒªã‚¹ãƒˆ';}const urlParams=new URLSearchParams(window.location.search);const listParam=urlParams.get('List');if(listParam){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}const pathSegments=window.location.pathname.split('/').filter(Boolean);for(let i=0;i<pathSegments.length;i++){const segment=this.safeDecodeURIComponent(pathSegments[i]);if(segment==='Shared Documents'||segment==='Documents'||segment==='ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ'){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}}return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}catch(e){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}},buildHierarchicalPath(siteName,breadcrumbPath){try{if(!siteName&&!breadcrumbPath)return null;const parts=[];if(siteName)parts.push(`â—† ${siteName}`);const libraryName=this.detectLibraryName();if(libraryName)parts.push(libraryName);if(breadcrumbPath){const breadcrumbParts=breadcrumbPath.split(' > ').filter(Boolean);const cleanParts=breadcrumbParts.filter(part=>part!==siteName&&!Utils.isExcludedText(part)&&part!==libraryName&&part!=='ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ'&&part!=='Documents'&&part!=='Shared Documents').map(part=>part.trim()).filter(part=>part.length>0);parts.push(...cleanParts);}else{const currentFolder=FolderNameExtractor.getCurrentFolderNameOnly();if(currentFolder&&currentFolder!==siteName&&!Utils.isTopLevelFolder(currentFolder,breadcrumbPath)&&currentFolder!==libraryName){parts.push(currentFolder);}}const validParts=parts.filter(part=>part&&part.trim().length>0);if(validParts.length<=1)return null;let result='';validParts.forEach((part,index)=>{const indent='ã€€'.repeat(index);const connector=index===0?'':'â”” ';result+=`${indent}${connector}${part}\n`;});return result.trim();}catch(e){console.warn('éšå±¤ãƒ‘ã‚¹æ§‹ç¯‰ã‚¨ãƒ©ãƒ¼:',e);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.UNKNOWN_ERROR,e,'hierarchical path building');return null;}},buildHierarchicalPathHTML(siteName,breadcrumbPath){try{if(!siteName&&!breadcrumbPath)return null;const parts=[];if(siteName)parts.push(`â—† ${siteName}`);const libraryName=this.detectLibraryName();if(libraryName)parts.push(libraryName);if(breadcrumbPath){const breadcrumbParts=breadcrumbPath.split(' > ').filter(Boolean);const cleanParts=breadcrumbParts.filter(part=>part!==siteName&&!Utils.isExcludedText(part)&&part!==libraryName&&part!=='ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ'&&part!=='Documents'&&part!=='Shared Documents').map(part=>part.trim()).filter(part=>part.length>0);parts.push(...cleanParts);}else{const currentFolder=FolderNameExtractor.getCurrentFolderNameOnly();if(currentFolder&&currentFolder!==siteName&&!Utils.isTopLevelFolder(currentFolder,breadcrumbPath)&&currentFolder!==libraryName){parts.push(currentFolder);}}const validParts=parts.filter(part=>part&&part.trim().length>0);if(validParts.length<=1)return null;let htmlResult='';validParts.forEach((part,index)=>{const htmlIndent='&nbsp;&nbsp;&nbsp;&nbsp;'.repeat(index);const htmlConnector=index===0?'':'â””&nbsp;';htmlResult+=`${htmlIndent}${htmlConnector}${part}<br>`;});return htmlResult.slice(0,-4);}catch(e){console.warn('éšå±¤ãƒ‘ã‚¹HTMLæ§‹ç¯‰ã‚¨ãƒ©ãƒ¼:',e);return null;}},cleanTextForCopy(text){if(!text)return'';return text.replace(/\s+$/,'').replace(/\n+$/,'').replace(/\r+$/,'').replace(/[\u200B-\u200D\uFEFF]/g,'');}};const EnvironmentDetector={cachedEnvironment:null,async detect(){if(this.cachedEnvironment){return this.cachedEnvironment;}try{return await ErrorHandler.handle(async()=>{const[modernUIResult,classicUIResult,newNavResult]=await Promise.all([PerformanceOptimizer.parallelSearch(CONFIG.selectors.modernUI,'querySelector'),PerformanceOptimizer.parallelSearch(CONFIG.selectors.classicUI,'querySelector'),PerformanceOptimizer.parallelSearch(CONFIG.selectors.newNav,'querySelector')]);const environment={isModernUI:!!modernUIResult,isClassicUI:!!classicUIResult,hasNewNav:!!newNavResult,userAgent:navigator.userAgent};this.cachedEnvironment=environment;return environment;},'environment detection');}catch(error){const defaultEnv={isModernUI:false,isClassicUI:false,hasNewNav:false,userAgent:navigator.userAgent};this.cachedEnvironment=defaultEnv;return defaultEnv;}}};const BreadcrumbExtractor={async getFullPath(){try{const breadcrumbRoot=await Utils.findElementBySelectors(['[data-automationid="breadcrumb-root-id"]','.breadcrumbList_9b39d68a','[class*="breadcrumbList"]','[data-automationid*="breadcrumb"]','.breadcrumbList']);if(breadcrumbRoot){const breadcrumbItems=breadcrumbRoot.querySelectorAll('[data-automationid="breadcrumb-crumb"]');if(breadcrumbItems.length>0){const pathParts=Array.from(breadcrumbItems).map(item=>{const text=item.textContent.trim();return Utils.isExcludedText(text)?null:text;}).filter(Boolean);if(pathParts.length>0){return pathParts.join(' > ');}}}const urlResult=this.extractFromURL();if(urlResult)return urlResult;const siteName=Utils.extractSiteName();const currentFolderName=await FolderNameExtractor.getCurrentFolderNameOnly();if(siteName&&currentFolderName&&!Utils.isTopLevelFolder(currentFolderName,null)){const topFolder=this.extractTopFolderFromContext();if(topFolder&&topFolder!==currentFolderName){return `${topFolder} > ${currentFolderName}`;}}}catch(e){console.warn('ãƒ–ãƒ¬ãƒƒãƒ‰ã‚¯ãƒ©ãƒ ãƒ‘ã‚¹å–å¾—ã‚¨ãƒ©ãƒ¼:',e);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,e,'breadcrumb path extraction');}return null;},extractFromURL(){try{const urlParams=new URLSearchParams(window.location.search);const id=urlParams.get('id')||urlParams.get('RootFolder');if(id){const decodedPath=Utils.safeDecodeURIComponent(id);return Utils.parseSharePointPath(decodedPath);}}catch(e){console.warn('URLéšå±¤è§£æã‚¨ãƒ©ãƒ¼:',e);return null;}return null;},extractTopFolderFromContext(){try{const url=window.location.href;if(url.includes('/Shared Documents')||url.includes('/Documents')){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}if(url.includes('/Lists/')){return'ãƒªã‚¹ãƒˆ';}const urlParams=new URLSearchParams(window.location.search);const list=urlParams.get('List');if(list){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}catch(e){return'ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ';}}};const FolderNameExtractor={async getCurrentFolderNameOnly(){try{const prioritySelector='.headerContent-title[data-automationid="headerTitleButton"]';const priorityElement=document.querySelector(prioritySelector);if(priorityElement&&priorityElement.textContent){const text=priorityElement.textContent.trim();if(!Utils.isExcludedText(text)){return text;}}const breadcrumbRoot=await Utils.findElementBySelectors(['[data-automationid="breadcrumb-root-id"]','.breadcrumbList_9b39d68a','[class*="breadcrumbList"]','[data-automationid*="breadcrumb"]','.breadcrumbList']);if(breadcrumbRoot){const breadcrumbItems=breadcrumbRoot.querySelectorAll('[data-automationid="breadcrumb-listitem"]');if(breadcrumbItems.length>0){const lastItem=breadcrumbItems[breadcrumbItems.length-1];const crumbElement=lastItem.querySelector('[data-automationid="breadcrumb-crumb"]');if(crumbElement&&crumbElement.textContent){const text=crumbElement.textContent.trim();if(!Utils.isExcludedText(text)){return text;}}}}}catch(e){console.warn('ãƒ•ã‚©ãƒ«ãƒ€åå–å¾—ã‚¨ãƒ©ãƒ¼:',e);}return null;},async fromBreadcrumb(){return await this.getCurrentFolderNameOnly();},fromUrl(){try{const urlParams=new URLSearchParams(window.location.search);const pathname=Utils.safeDecodeURIComponent(window.location.pathname);const rootFolder=urlParams.get('RootFolder');if(rootFolder){const folderPath=Utils.safeDecodeURIComponent(rootFolder);const segments=folderPath.split('/').filter(Boolean);if(segments.length>0){const lastSegment=segments[segments.length-1];if(lastSegment!=='Forms'&&lastSegment!=='AllItems.aspx'){return lastSegment;}}}const id=urlParams.get('id');if(id){const folderPath=Utils.safeDecodeURIComponent(id);const segments=folderPath.split('/').filter(Boolean);if(segments.length>0){const lastSegment=segments[segments.length-1];if(lastSegment!=='Forms'&&lastSegment!=='AllItems.aspx'){return lastSegment;}}}const pathSegments=pathname.split('/').filter(Boolean);const sharedDocsIndex=pathSegments.findIndex(segment=>segment.includes('Shared')||segment.includes('Documents')||segment.includes('Shared Documents'));if(sharedDocsIndex!==-1&&sharedDocsIndex<pathSegments.length-1){const folderSegments=pathSegments.slice(sharedDocsIndex+1);if(folderSegments.length>0){const lastFolder=folderSegments[folderSegments.length-1];if(lastFolder!=='Forms'&&lastFolder!=='AllItems.aspx'){return lastFolder;}}}}catch(e){console.warn('URLè§£æã‚¨ãƒ©ãƒ¼:',e);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.URL_ERROR,e,'URL parsing');}return null;},async fromDom(){const selectors=['.headerContent-title[data-automationid="headerTitleButton"]','[data-automation-id="listTitle"]','.ms-CommandBar-primaryCommand [title]','.od-TopBar-itemName','[data-automation-id="pageHeader"] [role="heading"]','[data-automation-id="modernPageHeader"] h1','[data-automation-id="modernPageHeader"] [role="heading"]','.modern-header-title','[class*="headerTitle"]','[class*="pageHeaderTitle"]','.ms-List-cell [data-selection-index="0"] [data-automation-id="FieldRenderer-name"]','.ms-Nav-link[aria-current="page"]','.ms-Nav-link.is-selected'];try{const element=await PerformanceOptimizer.parallelSearch(selectors,'querySelector');if(element){const text=(element.getAttribute('title')||element.textContent||'').trim();if(!Utils.isExcludedText(text)){return text;}}}catch(e){ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,e,'DOM parallel search');for(const selector of selectors){try{const element=document.querySelector(selector);if(element){const text=(element.getAttribute('title')||element.textContent||'').trim();if(!Utils.isExcludedText(text)){return text;}}}catch(e){continue;}}}return null;},fromPageTitle(title){const parts=title.split(" - ");return parts.length===3?parts[1]:title;},async extract(){const debugInfo=[];let folderName=null;try{folderName=await this.fromBreadcrumb();debugInfo.push(`ãƒ–ãƒ¬ãƒƒãƒ‰ã‚¯ãƒ©ãƒ : ${folderName||'ãªã—'}`);if(!folderName){folderName=this.fromUrl();debugInfo.push(`URLè§£æ: ${folderName||'ãªã—'}`);}if(!folderName){folderName=await this.fromDom();debugInfo.push(`DOMè¦ç´ : ${folderName||'ãªã—'}`);}if(!folderName){const retryDelay=PerformanceOptimizer.calculateRetryDelay(0,500);await new Promise(resolve=>setTimeout(resolve,retryDelay));folderName=await this.fromBreadcrumb()||await this.fromDom();debugInfo.push(`ãƒªãƒˆãƒ©ã‚¤(${retryDelay}ms): ${folderName||'ãªã—'}`);}if(!folderName){folderName=this.fromPageTitle(document.title);debugInfo.push(`ã‚¿ã‚¤ãƒˆãƒ«è§£æ: ${folderName||'ãªã—'}`);}if(!folderName||folderName.length===0){folderName=CONFIG.fallbackFolderName;debugInfo.push(`æœ€çµ‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ${folderName}`);}return{name:folderName,debugInfo:debugInfo};}catch(error){ErrorHandler.logDetailed('error',ErrorHandler.ErrorTypes.UNKNOWN_ERROR,error,'folder name extraction');return{name:CONFIG.fallbackFolderName,debugInfo:[...debugInfo,`ã‚¨ãƒ©ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ${CONFIG.fallbackFolderName}`]};}}};const FileListExtractor={detectItemType(row){try{const iconElements=row.querySelectorAll('[data-icon-name], .ms-Icon, [class*="icon"]');for(const icon of iconElements){const iconName=icon.getAttribute('data-icon-name')||icon.className||'';const lowerIconName=iconName.toLowerCase();if(lowerIconName.includes('folder')||lowerIconName.includes('directory')||lowerIconName.includes('fabricfolder')){return 'folder';}if(lowerIconName.includes('word')||lowerIconName.includes('worddocument')){return 'word';}if(lowerIconName.includes('excel')||lowerIconName.includes('exceldocument')){return 'excel';}if(lowerIconName.includes('powerpoint')||lowerIconName.includes('powerpointdocument')){return 'powerpoint';}if(lowerIconName.includes('pdf')){return 'pdf';}if(lowerIconName.includes('image')||lowerIconName.includes('photo')||lowerIconName.includes('picture')){return 'image';}}const nameElement=row.querySelector('[data-automationid="FieldRenderer-name"], [data-id="heroField"]');if(nameElement){const text=nameElement.textContent||'';if(text.includes('/')||text.toLowerCase().includes('folder')){return 'folder';}const fileName=text.trim().toLowerCase();if(fileName.endsWith('.docx')||fileName.endsWith('.doc')){return 'word';}if(fileName.endsWith('.xlsx')||fileName.endsWith('.xls')){return 'excel';}if(fileName.endsWith('.pptx')||fileName.endsWith('.ppt')){return 'powerpoint';}if(fileName.endsWith('.pdf')){return 'pdf';}if(fileName.match(/\.(jpg|jpeg|png|gif|bmp|svg)$/)){return 'image';}const hasExtension=/\.[a-zA-Z0-9]{1,5}$/.test(text.trim());return hasExtension?'file':'folder';}return 'file';}catch(e){return 'file';}},getFileTypeIcon(type){const iconMap={'folder':'ğŸ“','word':'ğŸ“','excel':'ğŸ“Š','powerpoint':'ğŸ“‹','pdf':'ğŸ“„','image':'ğŸ–¼ï¸','file':'ğŸ“„'};return iconMap[type]||'ğŸ“„';},getFileTypeStyle(type){return'color:#000000;font-weight:normal;';},extract(){try{let output="";let fileItems=[];const legacyRows=document.querySelectorAll(CONFIG.selectors.fileRows.legacy);if(legacyRows.length>0){const checkboxSelector=".ms-DetailsRow-cellCheck div:first-child[aria-checked=true]";const isUncheckedOld=!document.querySelector(checkboxSelector);if(CONFIG.performance.batchProcessing&&legacyRows.length>10){for(const cell of legacyRows){const checkElem=cell.querySelector(".ms-DetailsRow-cellCheck div:first-child");const isChecked=checkElem&&checkElem.getAttribute("aria-checked")?.toLowerCase()==="true";if(isChecked||isUncheckedOld){const nameElement=cell.querySelector('[data-automationid="FieldRenderer-name"]');if(nameElement){const itemName=nameElement.textContent.trim();const itemType=this.detectItemType(cell);const icon=this.getFileTypeIcon(itemType);if(output){output+="\n";}output+=`${icon} ${itemName}`;fileItems.push({name:itemName,type:itemType});}}}}else{legacyRows.forEach(cell=>{const checkElem=cell.querySelector(".ms-DetailsRow-cellCheck div:first-child");const isChecked=checkElem&&checkElem.getAttribute("aria-checked")?.toLowerCase()==="true";if(isChecked||isUncheckedOld){const nameElement=cell.querySelector('[data-automationid="FieldRenderer-name"]');if(nameElement){const itemName=nameElement.textContent.trim();const itemType=this.detectItemType(cell);const icon=this.getFileTypeIcon(itemType);if(output){output+="\n";}output+=`${icon} ${itemName}`;fileItems.push({name:itemName,type:itemType});}}});}}else{const modernRows=document.querySelectorAll(CONFIG.selectors.fileRows.modern);const selectedRows=Array.from(modernRows).filter(row=>row.getAttribute("aria-selected")==="true");const rowsToUse=selectedRows.length>0?selectedRows:modernRows;if(CONFIG.performance.batchProcessing&&rowsToUse.length>10){const validRows=Array.from(rowsToUse).filter(row=>!row.querySelector('[role="columnheader"]'));for(const row of validRows){const nameSpan=row.querySelector('[data-id="heroField"], [data-automationid="field-LinkFilename"] span');if(nameSpan){const itemName=nameSpan.textContent.trim();if(!Utils.isExcludedText(itemName)){const itemType=this.detectItemType(row);const icon=this.getFileTypeIcon(itemType);if(output){output+="\n";}output+=`${icon} ${itemName}`;fileItems.push({name:itemName,type:itemType});}}}            }else{rowsToUse.forEach(row=>{if(row.querySelector('[role="columnheader"]'))return;const nameSpan=row.querySelector('[data-id="heroField"], [data-automationid="field-LinkFilename"] span');if(nameSpan){const itemName=nameSpan.textContent.trim();if(!Utils.isExcludedText(itemName)){const itemType=this.detectItemType(row);const icon=this.getFileTypeIcon(itemType);if(output){output+="\n";}output+=`${icon} ${itemName}`;fileItems.push({name:itemName,type:itemType});}};});}}const cleanOutput=Utils.cleanTextForCopy(output);const result=cleanOutput+"\u200B";if(CONFIG.errorHandling.enableDetailedLogging){const perfStats=PerformanceOptimizer.getStats();ErrorHandler.logDetailed('info',ErrorHandler.ErrorTypes.DOM_ERROR,new Error('File list extraction completed'),`file list extraction: ${result.length} chars, perf: ${JSON.stringify(perfStats)}`);}return{textOutput:result,items:fileItems};}catch(error){console.error('ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆå–å¾—ã‚¨ãƒ©ãƒ¼:',error);ErrorHandler.logDetailed('error',ErrorHandler.ErrorTypes.DOM_ERROR,error,'file list extraction');ErrorHandler.updateStats(ErrorHandler.ErrorTypes.DOM_ERROR,error,'file list extraction');return{textOutput:"\u200B",items:[]};}}};const DialogManager={cleanupExistingDialogs(){try{const existingDialogs=document.querySelectorAll('[data-spo-bookmarklet="true"]');existingDialogs.forEach(dialog=>{try{dialog.close();dialog.remove();}catch(e){try{dialog.remove();}catch(e2){}}});}catch(e){ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,e,'cleanup existing dialogs');}},closeAndCleanup(dialog){try{dialog.close();setTimeout(()=>{try{if(dialog.parentNode){dialog.remove();}}catch(e){}},100);}catch(e){ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,e,'dialog cleanup');}}};const UIManager={injectStyles(){const style=document.createElement("style");style.innerHTML=CSS_STYLES;document.head.appendChild(style);},showMessage(){try{const existingMessage=document.querySelector('[data-spo-message="true"]');if(existingMessage){existingMessage.remove();}setTimeout(()=>{const message=document.createElement("div");message.setAttribute('data-spo-message','true');message.innerText="ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ";document.body.appendChild(message);setTimeout(()=>{message.classList.add("show");setTimeout(()=>{message.classList.remove("show");setTimeout(()=>{if(message.parentNode){message.parentNode.removeChild(message);}},300);},CONFIG.ui.messageTimeout);},10);},50);}catch(e){console.warn('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒ©ãƒ¼:',e);}},calculateFileListHeight(itemCount){const minHeight=Math.min(25,calc(1.3*1+16));const maxHeight=calc(1.3*3+16);const itemHeight=1.3;const padding=16;const calculatedHeight=Math.min(Math.max(itemCount*itemHeight+padding,minHeight),maxHeight);return calculatedHeight;},createDialog(folderName,url,fileListResult,breadcrumbPath,hierarchicalPath,debugInfo){const dialog=document.createElement("dialog");dialog.setAttribute('data-spo-bookmarklet','true');dialog.style.width=CONFIG.ui.dialogWidth;dialog.style.height=CONFIG.ui.dialogHeight;const perfStats=PerformanceOptimizer.getStats();const perfInfo=`Cache: ${perfStats.cacheHitRate}% (${perfStats.cacheHits}/${perfStats.cacheHits+perfStats.cacheMisses}), Avg: ${perfStats.avgSearchTime}ms`;let dialogContent=`<h3>ãƒ™ãƒ³ãƒªãã‚“ï¼šSPO Rich Text URL and Item List</h3><div class="content-section"><div class="folder-info">ãƒ•ã‚©ãƒ«ãƒ€: <a href="${url}" target="_blank">${folderName}</a></div></div><div class="content-section"><div id="fileList"></div></div>`;if(hierarchicalPath){const siteName=Utils.extractSiteName();const hierarchicalPathHTML=Utils.buildHierarchicalPathHTML(siteName,breadcrumbPath);dialogContent+=`<div class="hierarchical-path"><div class="path-title">è©³ç´°ãƒ‘ã‚¹:</div><div class="path-tree">${hierarchicalPathHTML||hierarchicalPath}</div></div>`;}dialogContent+=`<hr class="section-divider"><div class="section-title">ãƒªãƒ³ã‚¯ä»˜ãã‚³ãƒ”ãƒ¼ï¼ˆ<span style="font-weight: bold;">Teams</span>ã§<span style="font-weight: bold;">URL</span>å±•é–‹ãŒèµ·ãã‚‹å ´åˆã¯è²¼ã‚Šä»˜ã‘å¾Œã«<span style="font-weight: bold;">Ctrl+Z</span>ã‚’ï¼ï¼‰</div><div class="button-container link-buttons"><button id="allContentButton">å…¨éƒ¨ç››ã‚Š<br>ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰</button><button id="allContentRichButton">å…¨éƒ¨ç››ã‚Š<br>ï¼ˆãƒªãƒƒãƒï¼‰</button><button id="folderOnlyButton">ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆãƒªãƒ³ã‚¯ï¼‰<br>ã®ã¿</button><button id="folderWithItemsButton">ã€Enterã€‘ãƒ•ã‚©ãƒ«ãƒ€+ã‚¢ã‚¤ãƒ†ãƒ <br>ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰</button><button id="folderWithItemsRichButton">ãƒ•ã‚©ãƒ«ãƒ€+ã‚¢ã‚¤ãƒ†ãƒ <br>ï¼ˆãƒªãƒƒãƒï¼‰</button></div><div class="section-title">ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ”ãƒ¼</div><div class="button-container text-buttons"><button id="quotedItemsButton">ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§<br>ï¼ˆå¼•ç”¨ï¼‰</button><button id="bulletItemsButton">ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§<br>ï¼ˆç®‡æ¡æ›¸ãï¼‰</button><button id="plainItemsButton">ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§</button><button id="treePathButton">è©³ç´°ãƒ‘ã‚¹<br>(Tree)</button><button id="breadcrumbPathButton">è©³ç´°ãƒ‘ã‚¹<br>(ãƒ‘ãƒ³ããš)</button></div><div class="debug-info" title="ãƒ•ã‚©ãƒ«ãƒ€åå–å¾—ã®è©³ç´°æƒ…å ±ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµ±è¨ˆ"><strong>å–å¾—æ–¹æ³•:</strong> ${debugInfo.join(' | ')}<br><strong>Performance:</strong> ${perfInfo}</div><button id="closeDialog">é–‰ã˜ã‚‹</button>`;dialog.innerHTML=dialogContent;document.body.appendChild(dialog);const fileListElement=dialog.querySelector("#fileList");if(fileListResult.items&&fileListResult.items.length>0){let htmlContent='';fileListResult.items.forEach((item,index)=>{const itemText=item.name;const itemClass=item.type||'file';htmlContent+=`<div class="file-item ${itemClass}" title="${itemText}">${itemText}</div>`;});fileListElement.innerHTML=htmlContent;}else{fileListElement.textContent='ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“';}return dialog;}};const ClipboardManager={formatHierarchicalPathForHTML(hierarchicalPath){if(!hierarchicalPath)return'';return hierarchicalPath.replace(/ã€€/g,'&nbsp;&nbsp;&nbsp;&nbsp;').replace(/\n/g,'<br>');},generateAllContent(url,folderName,fileListResult,hierarchicalPath){const folderHtml=`<p><strong>ãƒ•ã‚©ãƒ«ãƒ€:</strong> <a href="${url}" target="_blank">${folderName}</a></p>`;let htmlContent=folderHtml;if(fileListResult.items&&fileListResult.items.length>0){let itemsHtml='';fileListResult.items.forEach((item,index)=>{itemsHtml+=`${item.name}`;if(index<fileListResult.items.length-1){itemsHtml+='<br>';}});if(itemsHtml.trim()){htmlContent+=`<blockquote style="border-left: 4px solid #6b7280; margin: 8px 0; padding-left: 12px; background-color: #f9fafb;">${itemsHtml}</blockquote>`;}}if(hierarchicalPath){const siteName=Utils.extractSiteName();const hierarchicalPathHTML=Utils.buildHierarchicalPathHTML(siteName,BreadcrumbExtractor.getFullPath())||this.formatHierarchicalPathForHTML(hierarchicalPath);htmlContent+=`<div style="margin-top: 10px;"><strong>è©³ç´°ãƒ‘ã‚¹:</strong><div style="font-family: inherit; white-space: normal; word-wrap: normal; margin: 5px 0;">${hierarchicalPathHTML}</div></div>`;}const cleanFileList=Utils.cleanTextForCopy(fileListResult.textOutput.replace(/\u200B$/,''));let plainText=`ãƒ•ã‚©ãƒ«ãƒ€: "${folderName} ${url}"`;if(cleanFileList){plainText+=`\r\n\r\n${cleanFileList}`;}if(hierarchicalPath){plainText+=`\r\n\r\nè©³ç´°ãƒ‘ã‚¹:\r\n${hierarchicalPath}`;}return{plainText:Utils.cleanTextForCopy(plainText),html:`<div>${htmlContent}</div>`};},generateAllContentRich(url,folderName,fileListResult,hierarchicalPath){const folderHtml=`<p><strong>ãƒ•ã‚©ãƒ«ãƒ€:</strong> <a href="${url}" target="_blank">${folderName}</a></p>`;let htmlContent=folderHtml;if(fileListResult.items&&fileListResult.items.length>0){let itemsHtml='';fileListResult.items.forEach((item,index)=>{const icon=FileListExtractor.getFileTypeIcon(item.type);const style=FileListExtractor.getFileTypeStyle(item.type);itemsHtml+=`<span style="${style}">${icon} ${item.name}</span>`;if(index<fileListResult.items.length-1){itemsHtml+='<br>';}});if(itemsHtml.trim()){htmlContent+=`<blockquote style="border-left: 4px solid #6b7280; margin: 8px 0; padding-left: 12px; background-color: #f9fafb;">${itemsHtml}</blockquote>`;}}if(hierarchicalPath){const siteName=Utils.extractSiteName();const hierarchicalPathHTML=Utils.buildHierarchicalPathHTML(siteName,BreadcrumbExtractor.getFullPath())||this.formatHierarchicalPathForHTML(hierarchicalPath);htmlContent+=`<div style="margin-top: 10px;"><strong>è©³ç´°ãƒ‘ã‚¹:</strong><div style="font-family: inherit; white-space: normal; word-wrap: normal; margin: 5px 0;">${hierarchicalPathHTML}</div></div>`;}const cleanFileList=Utils.cleanTextForCopy(fileListResult.textOutput.replace(/\u200B$/,''));let plainText=`ãƒ•ã‚©ãƒ«ãƒ€: "${folderName} ${url}"`;if(cleanFileList){plainText+=`\r\n\r\n${cleanFileList}`;}if(hierarchicalPath){plainText+=`\r\n\r\nè©³ç´°ãƒ‘ã‚¹:\r\n${hierarchicalPath}`;}return{plainText:Utils.cleanTextForCopy(plainText),html:`<div>${htmlContent}</div>`};},generateFolderWithPlainItems(url,folderName,fileListResult){const folderHtml=`<p><strong>ãƒ•ã‚©ãƒ«ãƒ€:</strong> <a href="${url}" target="_blank">${folderName}</a></p>`;let htmlContent=folderHtml;if(fileListResult.items&&fileListResult.items.length>0){let itemsHtml='';fileListResult.items.forEach((item,index)=>{itemsHtml+=`${item.name}`;if(index<fileListResult.items.length-1){itemsHtml+='<br>';}});const cleanItemsHtml=itemsHtml.trim().replace(/\s+$/,'');if(cleanItemsHtml){htmlContent+=`<blockquote style="border-left: 4px solid #6b7280; margin: 8px 0; padding-left: 12px; background-color: #f9fafb;"><span style="display: block;">${cleanItemsHtml}</span></blockquote><p>&nbsp;</p>`;}}const cleanFileList=Utils.cleanTextForCopy(fileListResult.textOutput.replace(/\u200B$/,''));let plainText=`ãƒ•ã‚©ãƒ«ãƒ€: "${folderName} ${url}"`;if(cleanFileList){plainText+=`\r\n\r\n${cleanFileList}\r\n `;}return{plainText:Utils.cleanTextForCopy(plainText),html:htmlContent.trim().replace(/\s+$/,'')};},generateFolderWithItemsRich(url,folderName,fileListResult){const folderHtml=`<p><strong>ãƒ•ã‚©ãƒ«ãƒ€:</strong> <a href="${url}" target="_blank">${folderName}</a></p>`;let htmlContent=folderHtml;if(fileListResult.items&&fileListResult.items.length>0){let itemsHtml='';fileListResult.items.forEach((item,index)=>{const icon=FileListExtractor.getFileTypeIcon(item.type);const style=FileListExtractor.getFileTypeStyle(item.type);itemsHtml+=`<span style="${style}">${icon} ${item.name}</span>`;if(index<fileListResult.items.length-1){itemsHtml+='<br>';}});const cleanItemsHtml=itemsHtml.trim().replace(/\s+$/,'');if(cleanItemsHtml){htmlContent+=`<blockquote style="border-left: 4px solid #6b7280; margin: 8px 0; padding-left: 12px; background-color: #f9fafb;"><span style="display: block;">${cleanItemsHtml}</span></blockquote><p>&nbsp;</p>`;}}const cleanFileList=Utils.cleanTextForCopy(fileListResult.textOutput.replace(/\u200B$/,''));let plainText=`ãƒ•ã‚©ãƒ«ãƒ€: "${folderName} ${url}"`;if(cleanFileList){plainText+=`\r\n\r\n${cleanFileList}\r\n `;}return{plainText:Utils.cleanTextForCopy(plainText),html:htmlContent.trim().replace(/\s+$/,'')};},generateFolderOnly(url,folderName){const htmlContent=`<div><p><strong>ãƒ•ã‚©ãƒ«ãƒ€:</strong> <a href="${url}" target="_blank">${folderName}</a></p></div>`;const plainText=`ãƒ•ã‚©ãƒ«ãƒ€: "${folderName} ${url}"`;return{plainText:plainText,html:htmlContent};},generateLinkedItemsOnly(fileListResult){let itemsHtml='';if(fileListResult.items&&fileListResult.items.length>0){fileListResult.items.forEach((item,index)=>{itemsHtml+=`${item.name}`;if(index<fileListResult.items.length-1){itemsHtml+='<br>';}});const cleanItemsHtml=itemsHtml.trim().replace(/\s+$/,'');const htmlContent=cleanItemsHtml?`<blockquote style="border-left: 4px solid #6b7280; margin: 8px 0; padding-left: 12px; background-color: #f9fafb;"><span style="display: block;">${cleanItemsHtml}</span></blockquote><p>&nbsp;</p>`:'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“';const cleanFileList=Utils.cleanTextForCopy(fileListResult.textOutput.replace(/\u200B$/,''));let plainTextWithSpace=cleanFileList||'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“';if(cleanFileList){plainTextWithSpace+='\r\n ';}return{plainText:plainTextWithSpace,html:htmlContent.trim().replace(/\s+$/,'')};}return{plainText:'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“',html:'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“'};},generateQuotedItemsRichText(fileListResult){if(!fileListResult.items||fileListResult.items.length===0){return{plainText:'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“',html:'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“'};}let itemsHtml='';fileListResult.items.forEach((item,index)=>{itemsHtml+=`${item.name}`;if(index<fileListResult.items.length-1){itemsHtml+='<br>';}});const htmlContent=`<blockquote style="border-left: 4px solid #6b7280; margin: 8px 0; padding-left: 12px; background-color: #f9fafb;">${itemsHtml}</blockquote><p>&nbsp;</p>`;const cleanFileList=Utils.cleanTextForCopy(fileListResult.textOutput.replace(/\u200B$/,''));return{plainText:cleanFileList||'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“',html:htmlContent};},generateBulletListRichText(fileListResult){if(!fileListResult.items||fileListResult.items.length===0){return{plainText:'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“',html:'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“'};}let itemsHtml='';fileListResult.items.forEach((item)=>{itemsHtml+=`<li>${item.name}</li>`;});const htmlContent=`<ul>${itemsHtml}</ul><p>&nbsp;</p>`;const cleanFileList=Utils.cleanTextForCopy(fileListResult.textOutput.replace(/\u200B$/,''));return{plainText:cleanFileList||'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“',html:htmlContent};},generatePlainItemsText(fileListResult){const lines=fileListResult.textOutput.split('\n');const cleanLines=lines.map(line=>{const trimmedLine=line.trim();if(!trimmedLine)return trimmedLine;const spaceIndex=trimmedLine.indexOf(' ');return spaceIndex>0?trimmedLine.substring(spaceIndex+1):trimmedLine;});const cleanFileList=Utils.cleanTextForCopy(cleanLines.join('\n').replace(/\u200B$/,''));return cleanFileList||'ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“';},generateTreePathText(hierarchicalPath){return hierarchicalPath||'è©³ç´°ãƒ‘ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“';},generateBreadcrumbText(hierarchicalPath){if(!hierarchicalPath)return'è©³ç´°ãƒ‘ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“';return hierarchicalPath.replace(/\n/g,' > ').replace(/ã€€+â”” /g,'').replace(/ã€€+/g,'').replace(/^[> ]+/,'').replace(/[> ]+$/,'');},async copyRichText(text,html,dialogElement){try{await ErrorHandler.handle(async()=>{const clipboardItem=new ClipboardItem({"text/plain":new Blob([text],{type:"text/plain"}),"text/html":new Blob([html],{type:"text/html"})});await navigator.clipboard.write([clipboardItem]);},'rich text clipboard copy');if(dialogElement){DialogManager.closeAndCleanup(dialogElement);UIManager.showMessage();}else{UIManager.showMessage();}}catch(err){console.error('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼ã‚¨ãƒ©ãƒ¼:',err);try{await navigator.clipboard.writeText(text);if(dialogElement){DialogManager.closeAndCleanup(dialogElement);UIManager.showMessage();}else{UIManager.showMessage();}}catch(fallbackErr){const userMessage=ErrorHandler.generateUserMessage(ErrorHandler.ErrorTypes.CLIPBOARD_ERROR,fallbackErr.message);alert(userMessage);}}},async copyPlainText(text,dialogElement){try{await ErrorHandler.handle(async()=>{await navigator.clipboard.writeText(text);},'plain text clipboard copy');if(dialogElement){DialogManager.closeAndCleanup(dialogElement);UIManager.showMessage();}else{UIManager.showMessage();}}catch(err){console.error('ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ”ãƒ¼ã‚¨ãƒ©ãƒ¼:',err);const userMessage=ErrorHandler.generateUserMessage(ErrorHandler.ErrorTypes.CLIPBOARD_ERROR,err.message);alert(userMessage);}}};async function main(){const startTime=performance.now();try{DialogManager.cleanupExistingDialogs();if(!isSharePointSite()){UIManager.injectStyles();const dialog=createGenericPageDialog();setupGenericPageEventHandlers(dialog);dialog.showModal();return;}const env=await EnvironmentDetector.detect();const folderResult=await FolderNameExtractor.extract();const folderName=folderResult.name;const debugInfo=folderResult.debugInfo;const breadcrumbPath=await BreadcrumbExtractor.getFullPath();const url=buildOptimalFolderUrl();const fileListResult=FileListExtractor.extract();if(typeof fileListResult.textOutput!=='string'){throw new Error('FileListExtractor.extract() did not return valid data');}const siteName=Utils.extractSiteName();const hierarchicalPath=Utils.buildHierarchicalPath(siteName,breadcrumbPath);UIManager.injectStyles();const dialog=UIManager.createDialog(folderName,url,fileListResult,breadcrumbPath,hierarchicalPath,debugInfo);const addSafeEventListener=(buttonId,handler)=>{const button=dialog.querySelector(buttonId);if(button){const wrappedHandler=function(event){try{handler.call(this,event);}catch(e){ErrorHandler.logDetailed('error',ErrorHandler.ErrorTypes.UNKNOWN_ERROR,e,`button handler: ${buttonId}`);DialogManager.closeAndCleanup(dialog);}};button.addEventListener("click",wrappedHandler,{passive:false,once:true});console.log(`ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ æˆåŠŸ: ${buttonId}`);}else{console.warn(`ãƒœã‚¿ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${buttonId}`);ErrorHandler.logDetailed('warn',ErrorHandler.ErrorTypes.DOM_ERROR,new Error(`Button not found: ${buttonId}`),'event listener setup');}};addSafeEventListener("#allContentButton",()=>{const content=ClipboardManager.generateAllContent(url,folderName,fileListResult,hierarchicalPath);ClipboardManager.copyRichText(content.plainText,content.html,dialog);});addSafeEventListener("#allContentRichButton",()=>{const content=ClipboardManager.generateAllContentRich(url,folderName,fileListResult,hierarchicalPath);ClipboardManager.copyRichText(content.plainText,content.html,dialog);});addSafeEventListener("#folderWithItemsButton",()=>{const content=ClipboardManager.generateFolderWithPlainItems(url,folderName,fileListResult);ClipboardManager.copyRichText(content.plainText,content.html,dialog);});addSafeEventListener("#folderWithItemsRichButton",()=>{const content=ClipboardManager.generateFolderWithItemsRich(url,folderName,fileListResult);ClipboardManager.copyRichText(content.plainText,content.html,dialog);});addSafeEventListener("#folderOnlyButton",()=>{const content=ClipboardManager.generateFolderOnly(url,folderName);ClipboardManager.copyRichText(content.plainText,content.html,dialog);});addSafeEventListener("#quotedItemsButton",()=>{const content=ClipboardManager.generateQuotedItemsRichText(fileListResult);ClipboardManager.copyRichText(content.plainText,content.html,dialog);});addSafeEventListener("#bulletItemsButton",()=>{const content=ClipboardManager.generateBulletListRichText(fileListResult);ClipboardManager.copyRichText(content.plainText,content.html,dialog);});addSafeEventListener("#plainItemsButton",()=>{const text=ClipboardManager.generatePlainItemsText(fileListResult);ClipboardManager.copyPlainText(text,dialog);});addSafeEventListener("#treePathButton",()=>{const text=ClipboardManager.generateTreePathText(hierarchicalPath);ClipboardManager.copyPlainText(text,dialog);});addSafeEventListener("#breadcrumbPathButton",()=>{const text=ClipboardManager.generateBreadcrumbText(hierarchicalPath);ClipboardManager.copyPlainText(text,dialog);});const closeButton=dialog.querySelector("#closeDialog");if(closeButton){closeButton.addEventListener("click",function(){DialogManager.closeAndCleanup(dialog);},{once:true});}dialog.addEventListener("click",function(event){if(event.target===dialog){DialogManager.closeAndCleanup(dialog);}},{once:true});dialog.addEventListener("keydown",function(event){if(event.key==="Enter"){event.preventDefault();const folderWithItemsButton=dialog.querySelector("#folderWithItemsButton");if(folderWithItemsButton){folderWithItemsButton.click();}}},{once:true});dialog.showModal();const endTime=performance.now();const totalTime=endTime-startTime;const perfStats=PerformanceOptimizer.getStats();if(CONFIG.errorHandling.enableDetailedLogging){console.log('SharePoint Bookmarklet Performance:',{totalExecutionTime:`${totalTime.toFixed(2)}ms`,...perfStats});}}catch(error){console.error('ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå®Ÿè¡Œã‚¨ãƒ©ãƒ¼:',error);ErrorHandler.updateStats(ErrorHandler.ErrorTypes.UNKNOWN_ERROR,error,'main execution');ErrorHandler.logDetailed('error',ErrorHandler.ErrorTypes.UNKNOWN_ERROR,error,'main execution');const userMessage=ErrorHandler.generateUserMessage(ErrorHandler.ErrorTypes.UNKNOWN_ERROR,error.message);alert(userMessage);}}main();})();
```

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

### Chrome

1. ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã‚’è¡¨ç¤ºï¼ˆChromeå³ä¸Šã€Œâ‹®ã€â†’ã€Œãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã€â†’ã€Œãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã‚’è¡¨ç¤ºã€ï¼‰

2. ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒãƒ¼ã§å³ã‚¯ãƒªãƒƒã‚¯â†’ã€Œãƒšãƒ¼ã‚¸ã‚’è¿½åŠ ã€

3. åå‰ã¯ä»»æ„ã§ã€URLã«ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘

4. ä¿å­˜

### Microsoft Edge

1. ãŠæ°—ã«å…¥ã‚Šãƒãƒ¼ã‚’è¡¨ç¤ºï¼ˆEdgeå³ä¸Šã€Œâ‹¯ã€â†’ã€ŒãŠæ°—ã«å…¥ã‚Šã€â†’ã€Œâ‹¯ã€â†’ã€ŒãŠæ°—ã«å…¥ã‚Šãƒãƒ¼ã‚’è¡¨ç¤ºã€ï¼‰

2. ãŠæ°—ã«å…¥ã‚Šãƒãƒ¼ã§å³ã‚¯ãƒªãƒƒã‚¯â†’ã€Œã“ã®ãƒšãƒ¼ã‚¸ã‚’ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ ã€

3. ã€Œè©³ç´°ã€â†’ åå‰ã¯ä»»æ„ã§ã€URLã«ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘

4. ä¿å­˜

## ä½¿ã„æ–¹

1. SharePointã®ãƒ•ã‚©ãƒ«ãƒ€ãƒšãƒ¼ã‚¸ã‚’é–‹ã

2. ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å¯¾è±¡ã«ã—ãŸã„å ´åˆã¯ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§é¸æŠï¼ˆä½•ã‚‚é¸æŠã—ãªã„å ´åˆã¯å…¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¯¾è±¡ï¼‰

3. ç™»éŒ²ã—ãŸãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯

4. è¡¨ç¤ºã•ã‚ŒãŸãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‹ã‚‰ç”¨é€”ã«å¿œã˜ã¦ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆEnterã‚­ãƒ¼ã§ã€Œãƒ•ã‚©ãƒ«ãƒ€+ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰ã€ãŒå®Ÿè¡Œï¼‰

5. Teamsã€Outlookã€ãƒ¡ãƒ¢å¸³ãªã©ã«è²¼ã‚Šä»˜ã‘

## ä½¿ç”¨ä¾‹

### Teams ã§ã®è²¼ã‚Šä»˜ã‘çµæœ
```
ãƒ•ã‚©ãƒ«ãƒ€: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆAè³‡æ–™ [SharePointãƒªãƒ³ã‚¯]

ğŸ“ ä¼ç”»æ›¸.docx
ğŸ“Š äºˆç®—è¡¨.xlsx  
ğŸ“‹ ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™.pptx

è©³ç´°ãƒ‘ã‚¹:
â—† ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚µã‚¤ãƒˆå
    â”” ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
        â”” 2024å¹´åº¦
            â”” ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆAè³‡æ–™
```

## å¯¾å¿œç’°å¢ƒ

**SharePoint Online**ï¼ˆMicrosoft 365ï¼‰

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ğŸš¨ é‡è¦ï¼šã‚³ãƒ”ãƒ¼ã—ãŸãƒªãƒ³ã‚¯ãŒå±•é–‹ã•ã‚Œã¦ã—ã¾ã†å ´åˆ

**Teamsã§è²¼ã‚Šä»˜ã‘å¾Œã« Ctrl+Z ã‚’æŠ¼ã™ã¨ãƒªãƒ³ã‚¯å±•é–‹ã‚’å–ã‚Šæ¶ˆã›ã¾ã™**

- Teamsã®ä»•æ§˜ã§ã€URLã‚’å«ã‚€ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã¨è‡ªå‹•çš„ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå±•é–‹ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
- ãã‚“ãªæ™‚ã¯ã€**Ctrl+Zã§å…ƒã®ã‚¿ã‚¤ãƒˆãƒ«ä»˜ããƒªãƒ³ã‚¯å½¢å¼ã«æˆ»ã›**ã¾ã™ã€‚
- ã‚‚ã©ã‹ã—ã„ã§ã™ãŒã€å¼µã‚Šä»˜ã‘ã¦ã€TeamsãŒURLå±•é–‹ã™ã‚‹ã®ã‚’ã¡ã‚‡ã£ã¨å¾…ã£ã¦ã€Ctrl+zã§æˆ»ã—ã¦ã€Enterã‚’æŠ¼ä¸‹ã™ã‚‹ã®ãŒç¢ºå®Ÿã§ã™ã€‚
- ã‚‚ã—ã‹ã™ã‚‹ã¨è²¼ã‚Šä»˜ã‘ã¦é€Ÿæ”»ã§Enterã§ã‚‚ã„ã‘ã‚‹ã‹ã‚‚....

### ãã®ä»–ã®ã‚ˆãã‚ã‚‹å•é¡Œ

**ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãŒå‹•ã‹ãªã„**
- ãƒšãƒ¼ã‚¸ãŒå®Œå…¨ã«èª­ã¿è¾¼ã¾ã‚Œã¦ã‹ã‚‰å®Ÿè¡Œ
- ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒšãƒ¼ã‚¸ã‚’æ›´æ–°ã—ã¦ã‹ã‚‰å†è©¦è¡Œ

**ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œãªã„** 
- SharePointã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã™ã‚‹ã‹ã€ãƒªã‚¹ãƒˆè¡¨ç¤ºã«ã—ã¦ã‹ã‚‰å®Ÿè¡Œ

**éšå±¤ãƒ‘ã‚¹ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„**
- ãƒ–ãƒ¬ãƒƒãƒ‰ã‚¯ãƒ©ãƒ ï¼ˆãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆï¼‰ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹çŠ¶æ…‹ã§å®Ÿè¡Œ

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

ã“ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã¨é€šä¿¡ã—ã¾ã›ã‚“ã€‚ã™ã¹ã¦ã®å‡¦ç†ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµã—ã€SharePointã®èªè¨¼æƒ…å ±ã‚„ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’å¤–éƒ¨ã«é€ä¿¡ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## æ³¨æ„ç‚¹

SharePointã®ç”»é¢ä»•æ§˜å¤‰æ›´ã«ã‚ˆã‚Šäºˆå‘Šãªãå‹•ä½œã—ãªããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã®å¯¾å¿œã¯å„è‡ªã§è¡Œã£ã¦ãã ã•ã„ã€‚
